{
"version":3,
"file":"editors.js",
"sourceRoot":"file://",
"sources":["/usr/lib/haxe/std/js/_std/EReg.hx","/usr/lib/haxe/std/js/_std/HxOverrides.hx","/Users/francoponticelli/projects/cards/editors/Main.hx","/usr/lib/haxe/std/js/_std/Std.hx","/usr/lib/haxe/std/StringTools.hx","/usr/lib/haxe/std/js/_std/Type.hx","/Users/francoponticelli/projects/cards/src/cards/components/Component.hx","/Users/francoponticelli/projects/cards/src/cards/components/Properties.hx","/Users/francoponticelli/projects/cards/src/cards/properties/Property.hx","/Users/francoponticelli/projects/cards/src/cards/properties/PropertyName.hx","/Users/francoponticelli/projects/cards/src/cards/ui/input/Editor.hx","/Users/francoponticelli/projects/cards/src/cards/ui/input/Path.hx","/Users/francoponticelli/projects/cards/src/cards/ui/input/TextEditor.hx","/Users/francoponticelli/projects/cards/src/cards/ui/input/TypedValue.hx","/usr/lib/haxe/std/haxe/CallStack.hx","/usr/lib/haxe/std/haxe/Log.hx","/usr/lib/haxe/std/js/_std/haxe/ds/StringMap.hx","/usr/lib/haxe/std/js/Boot.hx","/Users/francoponticelli/projects/thx.core/src/thx/core/Arrays.hx","/Users/francoponticelli/projects/thx.core/src/thx/core/Error.hx","/Users/francoponticelli/projects/thx.core/src/thx/core/Functions.hx","/Users/francoponticelli/projects/thx.core/src/thx/core/Ints.hx","/Users/francoponticelli/projects/thx.core/src/thx/core/Options.hx","/Users/francoponticelli/projects/thx.core/src/thx/core/Timer.hx","/Users/francoponticelli/projects/thx.core/src/thx/core/Tuple.hx","/Users/francoponticelli/projects/thx.promise/src/thx/promise/Deferred.hx","/Users/francoponticelli/projects/thx.promise/src/thx/promise/Promise.hx","/Users/francoponticelli/projects/thx.stream/src/thx/stream/Emitter.hx","/Users/francoponticelli/projects/thx.stream/src/thx/stream/Bus.hx","/Users/francoponticelli/projects/thx.stream/src/thx/stream/Stream.hx","/Users/francoponticelli/projects/thx.stream/src/thx/stream/Value.hx","/Users/francoponticelli/projects/thx.stream.dom/src/thx/stream/dom/Dom.hx","/Users/francoponticelli/projects/cards/src/udom/Dom.hx"],
"sourcesContent":["/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class EReg {\n\n\tvar r : Dynamic;\n\n\tpublic function new( r : String, opt : String ) : Void {\n\t\topt = opt.split(\"u\").join(\"\"); // 'u' (utf8) depends on page encoding\n\t\tthis.r = untyped __new__(\"RegExp\",r,opt);\n\t}\n\n\tpublic function match( s : String ) : Bool {\n\t\tif( r.global ) r.lastIndex = 0;\n\t\tr.m = r.exec(s);\n\t\tr.s = s;\n\t\treturn (r.m != null);\n\t}\n\n\tpublic function matched( n : Int ) : String {\n\t\treturn if( r.m != null && n >= 0 && n < r.m.length ) r.m[n] else throw \"EReg::matched\";\n\t}\n\n\tpublic function matchedLeft() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn r.s.substr(0,r.m.index);\n\t}\n\n\tpublic function matchedRight() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\tvar sz = r.m.index+r.m[0].length;\n\t\treturn r.s.substr(sz,r.s.length-sz);\n\t}\n\n\tpublic function matchedPos() : { pos : Int, len : Int } {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn { pos : r.m.index, len : r.m[0].length };\n\t}\n\n\tpublic function matchSub( s : String, pos : Int, len : Int = -1):Bool {\n\t\treturn if (r.global) {\n\t\t\tr.lastIndex = pos;\n\t\t\tr.m = r.exec(len < 0 ? s : s.substr(0, pos + len));\n\t\t\tvar b = r.m != null;\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t}\n\t\t\tb;\n\t\t} else {\n\t\t\t// TODO: check some ^/$ related corner cases\n\t\t\tvar b = match( len < 0 ? s.substr(pos) : s.substr(pos,len) );\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t\tr.m.index += pos;\n\t\t\t}\n\t\t\tb;\n\t\t}\n\t}\n\n\tpublic function split( s : String ) : Array<String> {\n\t\t// we can't use directly s.split because it's ignoring the 'g' flag\n\t\tvar d = \"#__delim__#\";\n\t\treturn untyped s.replace(r,d).split(d);\n\t}\n\n\tpublic function replace( s : String, by : String ) : String {\n\t\treturn untyped s.replace(r,by);\n\t}\n\n\tpublic function map( s : String, f : EReg -> String ) : String {\n\t\tvar offset = 0;\n\t\tvar buf = new StringBuf();\n\t\tdo {\n\t\t\tif (offset >= s.length)\n\t\t\t\tbreak;\n\t\t\telse if (!matchSub(s, offset)) {\n\t\t\t\tbuf.add(s.substr(offset));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar p = matchedPos();\n\t\t\tbuf.add(s.substr(offset, p.pos - offset));\n\t\t\tbuf.add(f(this));\n\t\t\tif (p.len == 0) {\n\t\t\t\tbuf.add(s.substr(p.pos, 1));\n\t\t\t\toffset = p.pos + 1;\n\t\t\t}\n\t\t\telse\n\t\t\t\toffset = p.pos + p.len;\n\t\t} while (r.global);\n\t\tif (!r.global && offset > 0 && offset < s.length)\n\t\t\tbuf.add(s.substr(offset));\n\t\treturn buf.toString();\n\t}\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:noDoc\nclass HxOverrides {\n\n\tstatic function dateStr( date :Date ) : String {\n\t\tvar m = date.getMonth() + 1;\n\t\tvar d = date.getDate();\n\t\tvar h = date.getHours();\n\t\tvar mi = date.getMinutes();\n\t\tvar s = date.getSeconds();\n\t\treturn date.getFullYear()\n\t\t\t+\"-\"+(if( m < 10 ) \"0\"+m else \"\"+m)\n\t\t\t+\"-\"+(if( d < 10 ) \"0\"+d else \"\"+d)\n\t\t\t+\" \"+(if( h < 10 ) \"0\"+h else \"\"+h)\n\t\t\t+\":\"+(if( mi < 10 ) \"0\"+mi else \"\"+mi)\n\t\t\t+\":\"+(if( s < 10 ) \"0\"+s else \"\"+s);\n\t}\n\n\tstatic function strDate( s : String ) : Date {\n\t\tswitch( s.length ) {\n\t\tcase 8: // hh:mm:ss\n\t\t\tvar k = s.split(\":\");\n\t\t\tvar d : Date = untyped __new__(Date);\n\t\t\tuntyped d[\"setTime\"](0);\n\t\t\tuntyped d[\"setUTCHours\"](k[0]);\n\t\t\tuntyped d[\"setUTCMinutes\"](k[1]);\n\t\t\tuntyped d[\"setUTCSeconds\"](k[2]);\n\t\t\treturn d;\n\t\tcase 10: // YYYY-MM-DD\n\t\t\tvar k = s.split(\"-\");\n\t\t\treturn new Date(cast k[0],cast untyped k[1] - 1,cast k[2],0,0,0);\n\t\tcase 19: // YYYY-MM-DD hh:mm:ss\n\t\t\tvar k = s.split(\" \");\n\t\t\tvar y = k[0].split(\"-\");\n\t\t\tvar t = k[1].split(\":\");\n\t\t\treturn new Date(cast y[0],cast untyped y[1] - 1,cast y[2],cast t[0],cast t[1],cast t[2]);\n\t\tdefault:\n\t\t\tthrow \"Invalid date format : \" + s;\n\t\t}\n\t}\n\n\tstatic function cca( s : String, index : Int ) : Null<Int> {\n\t\t#if mt\n\t\tvar x = (cast s).cca(index);\n\t\t#else\n\t\tvar x = (cast s).charCodeAt(index);\n\t\t#end\n\t\tif( x != x ) // fast isNaN\n\t\t\treturn untyped undefined; // isNaN will still return true\n\t\treturn x;\n\t}\n\n\tstatic function substr( s : String, pos : Int, ?len : Int ) : String {\n\t\tif( pos != null && pos != 0 && len != null && len < 0 ) return \"\";\n\t\tif( len == null ) len = s.length;\n\t\tif( pos < 0 ){\n\t\t\tpos = s.length + pos;\n\t\t\tif( pos < 0 ) pos = 0;\n\t\t}else if( len < 0 ){\n\t\t\tlen = s.length + len - pos;\n\t\t}\n\n\t\treturn (untyped s).substr(pos, len);\n\t}\n\n\tstatic function indexOf<T>( a : Array<T>, obj : T, i : Int) {\n\t\tvar len = a.length;\n\t\tif (i < 0) {\n\t\t\ti += len;\n\t\t\tif (i < 0) i = 0;\n\t\t}\n\t\twhile (i < len)\n\t\t{\n\t\t\tif (untyped __js__(\"a[i] === obj\"))\n\t\t\t\treturn i;\n\t\t\ti++;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic function lastIndexOf<T>( a : Array<T>, obj : T, i : Int) {\n\t\tvar len = a.length;\n\t\tif (i >= len)\n\t\t\ti = len - 1;\n\t\telse if (i < 0)\n\t\t\ti += len;\n\t\twhile (i >= 0)\n\t\t{\n\t\t\tif (untyped __js__(\"a[i] === obj\"))\n\t\t\t\treturn i;\n\t\t\ti--;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic function remove<T>( a : Array<T>, obj : T ) {\n\t\tvar i = a.indexOf(obj);\n\t\tif( i == -1 ) return false;\n\t\ta.splice(i,1);\n\t\treturn true;\n\t}\n\n\tstatic function iter<T>( a : Array<T> ) : Iterator<T> untyped {\n\t\treturn {\n\t\t\tcur : 0,\n\t\t\tarr : a,\n\t\t\thasNext : function() {\n\t\t\t\treturn __this__.cur < __this__.arr.length;\n\t\t\t},\n\t\t\tnext : function() {\n\t\t\t\treturn __this__.arr[__this__.cur++];\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic function __init__() untyped {\n#if !js_es5\n\t\t__feature__('HxOverrides.indexOf', if( Array.prototype.indexOf ) __js__(\"HxOverrides\").indexOf = function(a,o,i) return Array.prototype.indexOf.call(a, o, i));\n\t\t__feature__('HxOverrides.lastIndexOf', if( Array.prototype.lastIndexOf ) __js__(\"HxOverrides\").lastIndexOf = function(a,o,i) return Array.prototype.lastIndexOf.call(a, o, i));\n#end\n\n#if mt\n\t\tif( String.prototype.cca == null ) String.prototype.cca = String.prototype.charCodeAt;\n#end\n\t}\n\n}\n","import cards.components.Component;\nimport cards.ui.input.TextEditor;\nimport js.Browser;\nimport thx.promise.Promise;\nimport js.html.Element;\nusing udom.Dom.Query;\nusing thx.stream.Bus;\nusing thx.stream.dom.Dom;\n\nimport cards.ui.input.*;\nimport cards.ui.input.Path;\n\nclass Main {\n  public static function main() {\n\n\n    Dom.ready().success(function(_) {\n      var main = new Main(Query.first(\".container\"));\n      main.addDemo(\"text editor\", function(el) {\n        return new TextEditor(el);\n      });\n      main.addDemo(\"float editor\", toDo());\n      main.addDemo(\"date editor\", toDo());\n      main.addDemo(\"date time editor\", toDo());\n      main.addDemo(\"bool editor\", toDo());\n      main.addDemo(\"array editor\", toDo());\n      main.addDemo(\"object editor\", toDo());\n    });\n  }\n\n  static function toDo() {\n    return function(el) {\n      el.textContent = \"TODO\";\n      return null;\n    };\n  }\n\n  var container : Element;\n  public function new(container : Element) {\n    this.container = container;\n  }\n\n  public function addDemo(title : String, handler : Element -> IEditor) {\n    var heading = Browser.document.createElement('h2'),\n        el = Browser.document.createElement('div'),\n        output = Browser.document.createElement('div');\n    el.className = \"sample\";\n    output.className = \"output\";\n    heading.textContent = title;\n    container.appendChild(heading);\n    container.appendChild(el);\n    container.appendChild(output);\n    var editor = handler(el);\n    if(null == editor)\n      return;\n    editor.stream\n      .mapValue(function(v) return v.toString())\n      .subscribe(output.subscribeText());\n  }\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nimport js.Boot;\n\n@:keepInit\n@:coreApi class Std {\n\n\tpublic static inline function is( v : Dynamic, t : Dynamic ) : Bool {\n\t\treturn untyped js.Boot.__instanceof(v,t);\n\t}\n\n\tpublic static inline function instance<T:{},S:T>( value : T, c : Class<S> ) : S {\n\t\treturn untyped __instanceof__(value, c) ? cast value : null;\n\t}\n\n\tpublic static function string( s : Dynamic ) : String {\n\t\treturn untyped js.Boot.__string_rec(s,\"\");\n\t}\n\n\tpublic static inline function int( x : Float ) : Int {\n\t\treturn cast(x) | 0;\n\t}\n\n\tpublic static function parseInt( x : String ) : Null<Int> {\n\t\tvar v = untyped __js__(\"parseInt\")(x, 10);\n\t\t// parse again if hexadecimal\n\t\tif( v == 0 && (x.charCodeAt(1) == 'x'.code || x.charCodeAt(1) == 'X'.code) )\n\t\t\tv = untyped __js__(\"parseInt\")(x);\n\t\tif( untyped __js__(\"isNaN\")(v) )\n\t\t\treturn null;\n\t\treturn cast v;\n\t}\n\n\tpublic static function parseFloat( x : String ) : Float {\n\t\treturn untyped __js__(\"parseFloat\")(x);\n\t}\n\n\tpublic static function random( x : Int ) : Int {\n\t\treturn untyped x <= 0 ? 0 : Math.floor(Math.random()*x);\n\t}\n\n\tstatic function __init__() : Void untyped {\n\t\t__feature__(\"js.Boot.getClass\",String.prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"String\"] = String,String));\n\t\t__feature__(\"js.Boot.isClass\",String.__name__ = __feature__(\"Type.getClassName\",[\"String\"],true));\n\t\t__feature__(\"Type.resolveClass\",$hxClasses[\"Array\"] = Array);\n\t\t__feature__(\"js.Boot.isClass\",Array.__name__ = __feature__(\"Type.getClassName\",[\"Array\"],true));\n\t\t__feature__(\"Date.*\", {\n\t\t\t__feature__(\"js.Boot.getClass\",__js__('Date').prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"Date\"] = __js__('Date'),__js__('Date')));\n\t\t\t__feature__(\"js.Boot.isClass\",__js__('Date').__name__ = [\"Date\"]);\n\t\t});\n\t\t__feature__(\"Int.*\",{\n\t\t\tvar Int = __feature__(\"Type.resolveClass\", $hxClasses[\"Int\"] = { __name__ : [\"Int\"] }, { __name__ : [\"Int\"] });\n\t\t});\n\t\t__feature__(\"Dynamic.*\",{\n\t\t\tvar Dynamic = __feature__(\"Type.resolveClass\", $hxClasses[\"Dynamic\"] = { __name__ : [\"Dynamic\"] }, { __name__ : [\"Dynamic\"] });\n\t\t});\n\t\t__feature__(\"Float.*\",{\n\t\t\tvar Float = __feature__(\"Type.resolveClass\", $hxClasses[\"Float\"] = __js__(\"Number\"), __js__(\"Number\"));\n\t\t\tFloat.__name__ = [\"Float\"];\n\t\t});\n\t\t__feature__(\"Bool.*\",{\n\t\t\tvar Bool = __feature__(\"Type.resolveEnum\",$hxClasses[\"Bool\"] = __js__(\"Boolean\"), __js__(\"Boolean\"));\n\t\t\tBool.__ename__ = [\"Bool\"];\n\t\t});\n\t\t__feature__(\"Class.*\",{\n\t\t\tvar Class = __feature__(\"Type.resolveClass\", $hxClasses[\"Class\"] = { __name__ : [\"Class\"] }, { __name__ : [\"Class\"] });\n\t\t});\n\t\t__feature__(\"Enum.*\",{\n\t\t\tvar Enum = {};\n\t\t});\n\t\t__feature__(\"Void.*\",{\n\t\t\tvar Void = __feature__(\"Type.resolveEnum\", $hxClasses[\"Void\"] = { __ename__ : [\"Void\"] }, { __ename__ : [\"Void\"] });\n\t\t});\n\n#if !js_es5\n\t\t__feature__(\"Array.map\",\n\t\t\tif( Array.prototype.map == null )\n\t\t\t\tArray.prototype.map = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length )\n\t\t\t\t\t\ta[i] = f(__this__[i]);\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n\t\t__feature__(\"Array.filter\",\n\t\t\tif( Array.prototype.filter == null )\n\t\t\t\tArray.prototype.filter = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length ) {\n\t\t\t\t\t\tvar e = __this__[i];\n\t\t\t\t\t\tif( f(e) ) a.push(e);\n\t\t\t\t\t}\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n\tThis class provides advanced methods on Strings. It is ideally used with\n\t'using StringTools' and then acts as an extension to the String class.\n\n\tIf the first argument to any of the methods is null, the result is\n\tunspecified.\n**/\n#if cs\n@:keep\n#end\nclass StringTools {\n\t/**\n\t\tEncode an URL by using the standard format.\n\t**/\n\t#if (!java && !cpp) inline #end public static function urlEncode( s : String ) : String {\n\t\t#if flash9\n\t\t\treturn untyped __global__[\"encodeURIComponent\"](s);\n\t\t#elseif flash\n\t\t\treturn untyped _global[\"escape\"](s);\n\t\t#elseif neko\n\t\t\treturn untyped new String(_urlEncode(s.__s));\n\t\t#elseif js\n\t\t\treturn untyped encodeURIComponent(s);\n\t\t#elseif cpp\n\t\t\treturn untyped s.__URLEncode();\n\t\t#elseif java\n\t\t\ttry\n\t\t\t\treturn untyped __java__(\"java.net.URLEncoder.encode(s, \\\"UTF-8\\\")\")\n\t\t\tcatch (e:Dynamic) throw e;\n\t\t#elseif cs\n\t\t\treturn untyped cs.system.Uri.EscapeUriString(s);\n\t\t#elseif python\n\t\t\treturn python.lib.urllib.Parse.quote(s);\n\t\t#else\n\t\t\treturn null;\n\t\t#end\n\t}\n\n\t/**\n\t\tDecode an URL using the standard format.\n\t**/\n\t#if (!java && !cpp) inline #end public static function urlDecode( s : String ) : String {\n\t\t#if flash9\n\t\t\treturn untyped __global__[\"decodeURIComponent\"](s.split(\"+\").join(\" \"));\n\t\t#elseif flash\n\t\t\treturn untyped _global[\"unescape\"](s);\n\t\t#elseif neko\n\t\t\treturn untyped new String(_urlDecode(s.__s));\n\t\t#elseif js\n\t\t\treturn untyped decodeURIComponent(s.split(\"+\").join(\" \"));\n\t\t#elseif cpp\n\t\t\treturn untyped s.__URLDecode();\n\t\t#elseif java\n\t\t\ttry\n\t\t\t\treturn untyped __java__(\"java.net.URLDecoder.decode(s, \\\"UTF-8\\\")\")\n\t\t\tcatch (e:Dynamic) throw e;\n\t\t#elseif cs\n\t\t\treturn untyped cs.system.Uri.UnescapeDataString(s);\n\t\t#elseif python\n\t\t\treturn python.lib.urllib.Parse.unquote(s);\n\t\t#else\n\t\t\treturn null;\n\t\t#end\n\t}\n\n\t/**\n\t\tEscapes HTML special characters of the string `s`.\n\n\t\tThe following replacements are made:\n\n\t\t- `&` becomes `&amp`;\n\t\t- `<` becomes `&lt`;\n\t\t- `>` becomes `&gt`;\n\n\t\tIf `quotes` is true, the following characters are also replaced:\n\n\t\t- `\"` becomes `&quot`;\n\t\t- `'` becomes `&#039`;\n\t**/\n\tpublic static function htmlEscape( s : String, ?quotes : Bool ) : String {\n\t\ts = s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n\t\treturn quotes ? s.split('\"').join(\"&quot;\").split(\"'\").join(\"&#039;\") : s;\n\t}\n\n\t/**\n\t\tUnescapes HTML special characters of the string `s`.\n\n\t\tThis is the inverse operation to htmlEscape, i.e. the following always\n\t\tholds: htmlUnescape(htmlEscape(s)) == s\n\n\t\tThe replacements follow:\n\n\t\t- `&amp;` becomes `&`\n\t\t- `&lt;` becomes `<`\n\t\t- `&gt;` becomes `>`\n\t\t- `&quot;` becomes `\"`\n\t\t- `&#039;` becomes `'`\n\t**/\n\tpublic static function htmlUnescape( s : String ) : String {\n\t\treturn s.split(\"&gt;\").join(\">\").split(\"&lt;\").join(\"<\").split(\"&quot;\").join('\"').split(\"&#039;\").join(\"'\").split(\"&amp;\").join(\"&\");\n\t}\n\n\t/**\n\t\tTells if the string `s` starts with the string `start`.\n\n\t\tIf `start` is null, the result is unspecified.\n\n\t\tIf `start` is the empty String \"\", the result is true.\n\t**/\n\tpublic static #if (cs || java) inline #end function startsWith( s : String, start : String ) : Bool {\n\t\t#if java\n\t\treturn untyped s.startsWith(start);\n\t\t#elseif cs\n\t\treturn untyped s.StartsWith(start);\n\t\t#else\n\t\treturn( s.length >= start.length && s.substr(0, start.length) == start );\n\t\t#end\n\t}\n\n\t/**\n\t\tTells if the string `s` ends with the string `end`.\n\n\t\tIf `end` is null, the result is unspecified.\n\n\t\tIf `end` is the empty String \"\", the result is true.\n\t**/\n\tpublic static #if (cs || java) inline #end function endsWith( s : String, end : String ) : Bool {\n\t\t#if java\n\t\treturn untyped s.endsWith(end);\n\t\t#elseif cs\n\t\treturn untyped s.EndsWith(end);\n\t\t#else\n\t\tvar elen = end.length;\n\t\tvar slen = s.length;\n\t\treturn( slen >= elen && s.substr(slen - elen, elen) == end );\n\t\t#end\n\t}\n\n\t/**\n\t\tTells if the character in the string `s` at position `pos` is a space.\n\n\t\tA character is considered to be a space character if its character code\n\t\tis 9,10,11,12,13 or 32.\n\n\t\tIf `s` is the empty String \"\", or if pos is not a valid position within\n\t\t`s`, the result is false.\n\t**/\n\tpublic static function isSpace( s : String, pos : Int ) : Bool {\n\t\t#if python\n\t\tif (s.length == 0 || pos < 0 || pos >= s.length) return false;\n\t\t#end\n\t\tvar c = s.charCodeAt( pos );\n\t\treturn (c > 8 && c < 14) || c == 32;\n\t}\n\n\t/**\n\t\tRemoves leading space characters of `s`.\n\n\t\tThis function internally calls isSpace() to decide which characters to\n\t\tremove.\n\n\t\tIf `s` is the empty String \"\" or consists only of space characters, the\n\t\tresult is the empty String \"\".\n\t**/\n\tpublic #if cs inline #end static function ltrim( s : String ) : String {\n\t\t#if cs\n\t\treturn untyped s.TrimStart();\n\t\t#else\n\t\tvar l = s.length;\n\t\tvar r = 0;\n\t\twhile( r < l && isSpace(s,r) ){\n\t\t\tr++;\n\t\t}\n\t\tif( r > 0 )\n\t\t\treturn s.substr(r, l-r);\n\t\telse\n\t\t\treturn s;\n\t\t#end\n\t}\n\n\t/**\n\t\tRemoves trailing space characters of `s`.\n\n\t\tThis function internally calls isSpace() to decide which characters to\n\t\tremove.\n\n\t\tIf `s` is the empty String \"\" or consists only of space characters, the\n\t\tresult is the empty String \"\".\n\t**/\n\tpublic #if cs inline #end static function rtrim( s : String ) : String {\n\t\t#if cs\n\t\treturn untyped s.TrimEnd();\n\t\t#else\n\t\tvar l = s.length;\n\t\tvar r = 0;\n\t\twhile( r < l && isSpace(s,l-r-1) ){\n\t\t\tr++;\n\t\t}\n\t\tif( r > 0 ){\n\t\t\treturn s.substr(0, l-r);\n\t\t}else{\n\t\t\treturn s;\n\t\t}\n\t\t#end\n\t}\n\n\t/**\n\t\tRemoves leading and trailing space characters of `s`.\n\n\t\tThis is a convenience function for ltrim(rtrim(s)).\n\t**/\n\tpublic #if (cs || java) inline #end static function trim( s : String ) : String {\n\t\t#if cs\n\t\treturn untyped s.Trim();\n\t\t#elseif java\n\t\treturn untyped s.trim();\n\t\t#else\n\t\treturn ltrim(rtrim(s));\n\t\t#end\n\t}\n\n\t/**\n\t\tConcatenates `c` to `s` until `s.length` is at least `l`.\n\n\t\tIf `c` is the empty String \"\" or if `l` does not exceed `s.length`,\n\t\t`s` is returned unchanged.\n\n\t\tIf `c.length` is 1, the resulting String length is exactly `l`.\n\n\t\tOtherwise the length may exceed `l`.\n\n\t\tIf `c` is null, the result is unspecified.\n\t**/\n\tpublic static function lpad( s : String, c : String, l : Int ) : String {\n\t\tif (c.length <= 0)\n\t\t\treturn s;\n\n\t\twhile (s.length < l) {\n\t\t\ts = c + s;\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t\tAppends `c` to `s` until `s.length` is at least `l`.\n\n\t\tIf `c` is the empty String \"\" or if `l` does not exceed `s.length`,\n\t\t`s` is returned unchanged.\n\n\t\tIf `c.length` is 1, the resulting String length is exactly `l`.\n\n\t\tOtherwise the length may exceed `l`.\n\n\t\tIf `c` is null, the result is unspecified.\n\t**/\n\tpublic static function rpad( s : String, c : String, l : Int ) : String {\n\t\tif (c.length <= 0)\n\t\t\treturn s;\n\n\t\twhile (s.length < l) {\n\t\t\ts = s + c;\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t\tReplace all occurences of the String `sub` in the String `s` by the\n\t\tString `by`.\n\n\t\tIf `sub` is the empty String \"\", `by` is inserted after each character\n\t\tof `s`. If `by` is also the empty String \"\", `s` remains unchanged.\n\n\t\tThis is a convenience function for `s.split(sub).join(by)`.\n\n\t\tIf `sub` or `by` are null, the result is unspecified.\n\t**/\n\tpublic static function replace( s : String, sub : String, by : String ) : String {\n\t\t#if java\n\t\tif (sub.length == 0)\n\t\t\treturn s.split(sub).join(by);\n\t\telse\n\t\t\treturn untyped s.replace(sub, by);\n\t\t#elseif cs\n\t\tif (sub.length == 0)\n\t\t\treturn s.split(sub).join(by);\n\t\telse\n\t\t\treturn untyped s.Replace(sub, by);\n\t\t#else\n\t\treturn s.split(sub).join(by);\n\t\t#end\n\t}\n\n\t/**\n\t\tEncodes `n` into a hexadecimal representation.\n\n\t\tIf `digits` is specified, the resulting String is padded with \"0\" until\n\t\tits length equals `digits`.\n\t**/\n\tpublic static function hex( n : Int, ?digits : Int ) {\n\t\t#if flash9\n\t\t\tvar n : UInt = n;\n\t\t\tvar s : String = untyped n.toString(16);\n\t\t\ts = s.toUpperCase();\n\t\t#else\n\t\t\tvar s = \"\";\n\t\t\tvar hexChars = \"0123456789ABCDEF\";\n\t\t\tdo {\n\t\t\t\ts = hexChars.charAt(n&15) + s;\n\t\t\t\tn >>>= 4;\n\t\t\t} while( n > 0 );\n\t\t#end\n\t\t#if python\n\t\tif (digits != null && s.length < digits) {\n\t\t\tvar diff = digits - s.length;\n\t\t\tfor (_ in 0...diff) {\n\t\t\t\ts = \"0\" + s;\n\t\t\t}\n\t\t}\n\t\t#else\n\t\tif( digits != null )\n\t\t\twhile( s.length < digits )\n\t\t\t\ts = \"0\"+s;\n\t\t#end\n\t\treturn s;\n\t}\n\n\t/**\n\t\tReturns the character code at position `index` of String `s`, or an\n\t\tend-of-file indicator at if `position` equals `s.length`.\n\n\t\tThis method is faster than String.charCodeAt() on some platforms, but\n\t\tthe result is unspecified if `index` is negative or greater than\n\t\t`s.length`.\n\n\t\tEnd of file status can be checked by calling `StringTools.isEof` with\n\t\tthe returned value as argument.\n\n\t\tThis operation is not guaranteed to work if `s` contains the \\0\n\t\tcharacter.\n\t**/\n\tpublic static inline function fastCodeAt( s : String, index : Int ) : Int {\n\t\t#if neko\n\t\treturn untyped __dollar__sget(s.__s, index);\n\t\t#elseif cpp\n\t\treturn untyped s.cca(index);\n\t\t#elseif flash9\n\t\treturn untyped s.cca(index);\n\t\t#elseif flash\n\t\treturn untyped s[\"cca\"](index);\n\t\t#elseif java\n\t\treturn ( index < s.length ) ? cast(_charAt(s, index), Int) : -1;\n\t\t#elseif cs\n\t\treturn ( cast(index, UInt) < s.length ) ? cast(s[index], Int) : -1;\n\t\t#elseif js\n\t\treturn (untyped s).charCodeAt(index);\n\t\t#elseif python\n\t\treturn if (index >= s.length) -1 else python.lib.Builtin.ord(python.Syntax.arrayAccess(s, index));\n\t\t#else\n\t\treturn untyped s.cca(index);\n\t\t#end\n\t}\n\n\t/*\n\t\tTells if `c` represents the end-of-file (EOF) character.\n\t*/\n\t@:noUsing public static inline function isEof( c : Int ) : Bool {\n\t\t#if (flash9 || cpp)\n\t\treturn c == 0;\n\t\t#elseif flash8\n\t\treturn c <= 0; // fast NaN\n\t\t#elseif js\n\t\treturn c != c; // fast NaN\n\t\t#elseif neko\n\t\treturn c == null;\n\t\t#elseif cs\n\t\treturn c == -1;\n\t\t#elseif java\n\t\treturn c == -1;\n\t\t#elseif python\n\t\treturn c == -1;\n\t\t#else\n\t\treturn false;\n\t\t#end\n\t}\n\n\t#if java\n\tprivate static inline function _charAt(str:String, idx:Int):java.StdTypes.Char16 return untyped str._charAt(idx);\n\t#end\n\n\t#if neko\n\tprivate static var _urlEncode = neko.Lib.load(\"std\",\"url_encode\",1);\n\tprivate static var _urlDecode = neko.Lib.load(\"std\",\"url_decode\",1);\n\t#end\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nenum ValueType {\n\tTNull;\n\tTInt;\n\tTFloat;\n\tTBool;\n\tTObject;\n\tTFunction;\n\tTClass( c : Class<Dynamic> );\n\tTEnum( e : Enum<Dynamic> );\n\tTUnknown;\n}\n\n@:coreApi class Type {\n\n\tpublic static function getClass<T>( o : T ) : Class<T> untyped {\n\t\tif( o == null )\n\t\t\treturn null;\n\t\treturn js.Boot.getClass(o);\n\t}\n\n\tpublic static function getEnum( o : EnumValue ) : Enum<Dynamic> untyped {\n\t\tif( o == null )\n\t\t\treturn null;\n\t\treturn o.__enum__;\n\t}\n\n\tpublic static function getSuperClass( c : Class<Dynamic> ) : Class<Dynamic> untyped {\n\t\treturn c.__super__;\n\t}\n\n\n\tpublic static function getClassName( c : Class<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped c.__name__;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function getEnumName( e : Enum<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped e.__ename__;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function resolveClass( name : String ) : Class<Dynamic> untyped {\n\t\tvar cl : Class<Dynamic> = $hxClasses[name];\n\t\t// ensure that this is a class\n\t\tif( cl == null || !js.Boot.isClass(cl) )\n\t\t\treturn null;\n\t\treturn cl;\n\t}\n\n\tpublic static function resolveEnum( name : String ) : Enum<Dynamic> untyped {\n\t\tvar e : Dynamic = $hxClasses[name];\n\t\t// ensure that this is an enum\n\t\tif( e == null || !js.Boot.isEnum(e) )\n\t\t\treturn null;\n\t\treturn e;\n\t}\n\n\tpublic static function createInstance<T>( cl : Class<T>, args : Array<Dynamic> ) : T untyped {\n\t\tswitch( args.length ) {\n\t\tcase 0:\n\t\t\treturn __new__(cl);\n\t\tcase 1:\n\t\t\treturn __new__(cl,args[0]);\n\t\tcase 2:\n\t\t\treturn __new__(cl,args[0],args[1]);\n\t\tcase 3:\n\t\t\treturn __new__(cl,args[0],args[1],args[2]);\n\t\tcase 4:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3]);\n\t\tcase 5:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4]);\n\t\tcase 6:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5]);\n\t\tcase 7:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6]);\n\t\tcase 8:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7]);\n\t\tdefault:\n\t\t\tthrow \"Too many arguments\";\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic static function createEmptyInstance<T>( cl : Class<T> ) : T untyped {\n\t\t__js__(\"function empty() {}; empty.prototype = cl.prototype\");\n\t\treturn __js__(\"new empty()\");\n\t}\n\n\tpublic static function createEnum<T>( e : Enum<T>, constr : String, ?params : Array<Dynamic> ) : T {\n\t\tvar f = Reflect.field(e,constr);\n\t\tif( f == null ) throw \"No such constructor \"+constr;\n\t\tif( Reflect.isFunction(f) ) {\n\t\t\tif( params == null ) throw \"Constructor \"+constr+\" need parameters\";\n\t\t\treturn Reflect.callMethod(e,f,params);\n\t\t}\n\t\tif( params != null && params.length != 0 )\n\t\t\tthrow \"Constructor \"+constr+\" does not need parameters\";\n\t\treturn f;\n\t}\n\n\tpublic static function createEnumIndex<T>( e : Enum<T>, index : Int, ?params : Array<Dynamic> ) : T {\n\t\tvar c : String = (untyped e.__constructs__)[index];\n\t\tif( c == null ) throw index+\" is not a valid enum constructor index\";\n\t\treturn createEnum(e,c,params);\n\t}\n\n\tpublic static function getInstanceFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = [];\n\t\tuntyped __js__(\"for(var i in c.prototype) a.push(i)\");\n\t\ta.remove(\"__class__\");\n\t\ta.remove(\"__properties__\");\n\t\treturn a;\n\t}\n\n\tpublic static function getClassFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = Reflect.fields(c);\n\t\ta.remove(\"__name__\");\n\t\ta.remove(\"__interfaces__\");\n\t\ta.remove(\"__properties__\");\n\t\ta.remove(\"__super__\");\n\t\ta.remove(\"prototype\");\n\t\treturn a;\n\t}\n\n\tpublic static function getEnumConstructs( e : Enum<Dynamic> ) : Array<String> {\n\t\tvar a : Array<String> = untyped e.__constructs__;\n\t\treturn a.copy();\n\t}\n\n\tpublic static function typeof( v : Dynamic ) : ValueType untyped {\n\t\tswitch( __js__(\"typeof\")(v) ) {\n\t\tcase \"boolean\": return TBool;\n\t\tcase \"string\": return TClass(String);\n\t\tcase \"number\":\n\t\t\t// this should handle all cases : NaN, +/-Inf and Floats outside range\n\t\t\tif( Math.ceil(v) == v%2147483648.0 )\n\t\t\t\treturn TInt;\n\t\t\treturn TFloat;\n\t\tcase \"object\":\n\t\t\tif( v == null )\n\t\t\t\treturn TNull;\n\t\t\tvar e = v.__enum__;\n\t\t\tif( e != null )\n\t\t\t\treturn TEnum(e);\n\t\t\tvar c = js.Boot.getClass(v);\n\t\t\tif( c != null )\n\t\t\t\treturn TClass(c);\n\t\t\treturn TObject;\n\t\tcase \"function\":\n\t\t\tif( js.Boot.isClass(v) || js.Boot.isEnum(v) )\n\t\t\t\treturn TObject;\n\t\t\treturn TFunction;\n\t\tcase \"undefined\":\n\t\t\treturn TNull;\n\t\tdefault:\n\t\t\treturn TUnknown;\n\t\t}\n\t}\n\n\tpublic static function enumEq<T>( a : T, b : T ) : Bool untyped {\n\t\tif( a == b )\n\t\t\treturn true;\n\t\ttry {\n\t\t\tif( a[0] != b[0] )\n\t\t\t\treturn false;\n\t\t\tfor( i in 2...a.length )\n\t\t\t\tif( !enumEq(a[i],b[i]) )\n\t\t\t\t\treturn false;\n\t\t\tvar e = a.__enum__;\n\t\t\tif( e != b.__enum__ || e == null )\n\t\t\t\treturn false;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic inline static function enumConstructor( e : EnumValue ) : String {\n\t\treturn untyped e[0];\n\t}\n\n\tpublic inline static function enumParameters( e : EnumValue ) : Array<Dynamic> {\n\t\treturn untyped e.slice(2);\n\t}\n\n\tpublic inline static function enumIndex( e : EnumValue ) : Int {\n\t\treturn untyped e[1];\n\t}\n\n\tpublic static function allEnums<T>( e : Enum<T> ) : Array<T> {\n\t\treturn untyped e.__empty_constructs__;\n\t}\n\n}\n\n","package cards.components;\n\nimport udom.Dom;\nimport js.html.Element;\n\nclass Component {\n  public var children(get, null) : Iterable<Component>;\n  public var isAttached(default, null) : Bool = false;\n  public var parent(default, null) : Component;\n  public var properties(default, null) : Properties;\n  public var el(default, null) : Element;\n  var list : Array<Component>;\n\n  public function new(options : ComponentOptions) {\n    list = [];\n    properties = new Properties(this);\n    if(null == options.template) {\n      if(null == options.el)\n        throw '$this needs a template';\n      else {\n        el = options.el;\n        if(null != el.parentElement) {\n          isAttached = true;\n        }\n      }\n    } else {\n      el = Html.parse(options.template);\n    }\n    if(null != options.classes)\n      options.classes.split(' ').map(el.classList.add);\n    if(null != options.parent)\n      options.parent.add(this);\n    if(null != options.container)\n      appendTo(options.container);\n  }\n\n  public function appendTo(container : Element) {\n    container.appendChild(el);\n    isAttached = true;\n  }\n\n  public function detach() {\n    if(!isAttached)\n      throw 'Component is not attached';\n    el.parentElement.removeChild(el);\n    isAttached = false;\n  }\n\n  public function destroy() {\n    if(null != parent)\n      parent.remove(this);\n    if(isAttached)\n      detach();\n    properties.removeAll();\n  }\n\n  public function add(child : Component) {\n    if(null != child.parent)\n      child.parent.remove(child);\n    list.push(child);\n    child.parent = this;\n  }\n\n  public function remove(child : Component) {\n    if(!list.remove(child))\n      throw '$child is not a child of $this';\n    child.parent = null;\n  }\n\n  function get_children()\n    return list;\n\n  public function toString()\n    return Type.getClassName(Type.getClass(this)).split('.').pop();\n}","package cards.components;\n\nimport cards.properties.Property;\nimport cards.properties.PropertyName;\n\nclass Properties {\n  var properties : Map<String, Property>;\n  var target : Component;\n  public function new(target : Component) {\n    this.target = target;\n    properties = new Map();\n  }\n\n  public function removeAll() {\n    for(name in properties.keys())\n      remove(name);\n  }\n\n  function add(property : Property) {\n    if(properties.exists(property.name))\n      throw '$target already has a property $property';\n    properties.set(property.name, property);\n  }\n\n  public function get(name : PropertyName) {\n    return properties.get(name);\n  }\n\n  public function exists(name : PropertyName) {\n    return properties.exists(name);\n  }\n\n  function remove(name : PropertyName) {\n    if(!properties.exists(name))\n      throw 'property \"${name}\" does not exist in $target';\n    var prop = properties.get(name);\n    properties.remove(name);\n    prop.dispose();\n  }\n}","package cards.properties;\n\nimport cards.components.Component;\n\n@:access(cards.components.Properties)\nclass Property {\n  public var component(default, null) : Component;\n  public var name(default, null) : String;\n  var cancels : Array<Void -> Void>;\n  public function new(component : Component, name : String) {\n    this.component = component;\n    this.name = name;\n    cancels = [];\n    component.properties.add(this);\n  }\n\n  public function dispose() {\n    while(cancels.length > 0)\n      cancels.shift()();\n    if(this.component.properties.exists(name)) {\n      this.component.properties.remove(name);\n      this.component = null;\n    }\n  }\n\n  public function toString()\n    return Type.getClassName(Type.getClass(this)).split('.').pop();\n}","package cards.properties;\n\nabstract PropertyName(String) {\n  @:from public inline static function fromProperty(property : Property)\n    return new PropertyName(property.name);\n\n  @:from public inline static function fromString(name : String)\n    return new PropertyName(name);\n\n  public inline function new(name : String)\n    this = name;\n\n  @:to public inline function toString()\n    return this;\n}","package cards.ui.input;\n\nimport cards.components.Component;\nimport cards.components.ComponentOptions;\nimport cards.model.SchemaType;\nimport thx.stream.Bus;\nimport thx.stream.Value;\n\n// TODO add interface IRoutedEditor to support path\nclass Editor implements IEditor {\n  public var stream(default, null) : Bus<TypedValue>;\n  public var type(default, null) : SchemaType;\n  public var focus(default, null) : Value<Bool>;\n  public var component(default, null) : Component;\n\n  public function new(type : SchemaType, options : ComponentOptions) {\n    this.stream    = new Bus();\n    this.type      = type;\n    this.focus     = new Value(false);\n    this.component = new Component(options);\n  }\n}","package cards.ui.input;\n\nusing StringTools;\n\nabstract Path(Array<PathItem>) from Array<PathItem> to Array<PathItem> {\n  inline public function new(arr : Array<PathItem>)\n    this = arr;\n\n  @:from public static function fromString(path : String)\n    return path.replace('[', '.[').split('.').map(function(v) {\n        if(v.substr(0,1) == '[')\n          return Index(Std.parseInt(v.substr(1, v.length - 1)));\n        else\n          return Field(v);\n      });\n\n  @:to public function toString()\n    return this.map(function(item) return switch item {\n        case Field(name): name.replace('.', '\\\\.');\n        case Index(pos): '[$pos]';\n      }).join('.').replace('.[', '[');\n}\n\nenum PathItem {\n  Field(name : String);\n  Index(pos : Int);\n}","package cards.ui.input;\n\nimport cards.components.ComponentOptions;\nimport cards.model.SchemaType;\nimport js.html.Element;\nimport udom.Dom.Query;\nusing thx.stream.dom.Dom;\n\nclass TextEditor extends Editor {\n  public function new(container : Element) {\n    var options = {\n      template  : '<span class=\"editor text\" contenteditable>text</span>',\n      container : container\n    };\n    super(StringType, options);\n\n    var el = component.el;\n    el.style.content = 'type text';\n    el.streamEvent('input')\n      .mapValue(function(_) return (el.textContent : TypedValue))\n      .plug(stream);\n  }\n}","package cards.ui.input;\n\nimport cards.model.SchemaType;\nimport thx.core.Tuple;\n\nabstract TypedValue(Tuple2<SchemaType, Dynamic>) {\n  public inline function new(type : SchemaType, value : Dynamic)\n    this = new Tuple2(type, value);\n\n  @:to public inline function toType()\n    return this._0;\n\n  @:from public static inline function fromString(s : String)\n    return new TypedValue(StringType, s);\n\n  @:to public function asString()\n    return Std.string(this._1); // TODO use type transform here\n\n  public function toString()\n    return Std.string(this._1) + ' : ' + Std.string(this._0);\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tElements return by `CallStack` methods.\n**/\nenum StackItem {\n\tCFunction;\n\tModule( m : String );\n\tFilePos( s : Null<StackItem>, file : String, line : Int );\n\tMethod( classname : String, method : String );\n\tLocalFunction( v : Int );\n}\n\n/**\n\tGet informations about the call stack.\n**/\nclass CallStack {\n\n\t/**\n\t\tReturn the call stack elements, or an empty array if not available.\n\t**/\n\tpublic static function callStack() : Array<StackItem> {\n\t\t#if neko\n\t\t\tvar a = makeStack(untyped __dollar__callstack());\n\t\t\ta.shift(); // remove Stack.callStack()\n\t\t\treturn a;\n\t\t#elseif flash9\n\t\t\tvar a = makeStack( new flash.errors.Error().getStackTrace() );\n\t\t\ta.shift(); // remove Stack.callStack()\n\t\t\treturn a;\n\t\t#elseif flash\n\t\t\treturn makeStack(\"$s\");\n\t\t#elseif php\n\t\t\treturn makeStack(\"%s\");\n\t\t#elseif cpp\n\t\t\tvar s:Array<String> = untyped __global__.__hxcpp_get_call_stack(true);\n\t\t\treturn makeStack(s);\n\t\t#elseif js\n\t\t\t// https://code.google.com/p/v8/wiki/JavaScriptStackTraceApi\n\t\t\tvar oldValue = (untyped Error).prepareStackTrace;\n\t\t\t(untyped Error).prepareStackTrace = function (error, callsites :Array<Dynamic>) {\n\t\t\t\tvar stack = [];\n\t\t\t\tfor (site in callsites) {\n\t\t\t\t\tvar method = null;\n\t\t\t\t\tvar fullName :String = site.getFunctionName();\n\t\t\t\t\tif (fullName != null) {\n\t\t\t\t\t\tvar idx = fullName.lastIndexOf(\".\");\n\t\t\t\t\t\tif (idx >= 0) {\n\t\t\t\t\t\t\tvar className = fullName.substr(0, idx);\n\t\t\t\t\t\t\tvar methodName = fullName.substr(idx+1);\n\t\t\t\t\t\t\tmethod = Method(className, methodName);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tstack.push(FilePos(method, site.getFileName(), site.getLineNumber()));\n\t\t\t\t}\n\t\t\t\treturn stack;\n\t\t\t}\n\t\t\tvar a = makeStack(untyped __new__(\"Error\").stack);\n\t\t\ta.shift(); // remove Stack.callStack()\n\t\t\t(untyped Error).prepareStackTrace = oldValue;\n\t\t\treturn a;\n\t\t#elseif java\n\t\t\tvar stack = [];\n\t\t\tfor ( el in java.lang.Thread.currentThread().getStackTrace() ) {\n\t\t\t\tvar className = el.getClassName();\n\t\t\t\tvar methodName = el.getMethodName();\n\t\t\t\tvar fileName = el.getFileName();\n\t\t\t\tvar lineNumber = el.getLineNumber();\n\t\t\t\tvar method = Method( className, methodName );\n\t\t\t\tif ( fileName != null || lineNumber >= 0 ) {\n\t\t\t\t\tstack.push( FilePos( method, fileName, lineNumber ) );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tstack.push( method );\n\t\t\t\t}\n\t\t\t}\n\t\t\tstack.shift();\n\t\t\tstack.shift();\n\t\t\tstack.pop();\n\t\t\treturn stack;\n\t\t#elseif cs\n\t\t\treturn makeStack(new cs.system.diagnostics.StackTrace(1, true));\n\t\t#elseif python\n\t\t\tvar stack = [];\n\t\t\tvar infos = python.lib.Traceback.extract_stack();\n\t\t\tinfos.pop();\n\t\t\tinfos.reverse();\n\t\t\tfor (elem in infos)\n\t\t\t\tstack.push(FilePos(null, elem._1, elem._2));\n\t\t\treturn stack;\n\t\t#else\n\t\t\treturn []; // Unsupported\n\t\t#end\n\t}\n\n\t/**\n\t\tReturn the exception stack : this is the stack elements between\n\t\tthe place the last exception was thrown and the place it was\n\t\tcaught, or an empty array if not available.\n\t**/\n\t#if cpp @:noStack #end /* Do not mess up the exception stack */\n\tpublic static function exceptionStack() : Array<StackItem> {\n\t\t#if neko\n\t\t\treturn makeStack(untyped __dollar__excstack());\n\t\t#elseif as3\n\t\t\treturn new Array();\n\t\t#elseif flash9\n\t\t\tvar err : flash.errors.Error = untyped flash.Boot.lastError;\n\t\t\tif( err == null ) return new Array();\n\t\t\tvar a = makeStack( err.getStackTrace() );\n\t\t\tvar c = callStack();\n\t\t\tvar i = c.length - 1;\n\t\t\twhile( i > 0 ) {\n\t\t\t\tif( Std.string(a[a.length-1]) == Std.string(c[i]) )\n\t\t\t\t\ta.pop();\n\t\t\t\telse\n\t\t\t\t\tbreak;\n\t\t\t\ti--;\n\t\t\t}\n\t\t\treturn a;\n\t\t#elseif flash\n\t\t\treturn makeStack(\"$e\");\n\t\t#elseif php\n\t\t\treturn makeStack(\"%e\");\n\t\t#elseif cpp\n\t\t\tvar s:Array<String> = untyped __global__.__hxcpp_get_exception_stack();\n\t\t\treturn makeStack(s);\n\t\t#elseif java\n\t\t\tvar stack = [];\n\t\t\tfor ( el in java.internal.Exceptions.currentException().getStackTrace() ) {\n\t\t\t\tvar className = el.getClassName();\n\t\t\t\tvar methodName = el.getMethodName();\n\t\t\t\tvar fileName = el.getFileName();\n\t\t\t\tvar lineNumber = el.getLineNumber();\n\t\t\t\tvar method = Method( className, methodName );\n\t\t\t\tif ( fileName != null || lineNumber >= 0 ) {\n\t\t\t\t\tstack.push( FilePos( method, fileName, lineNumber ) );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tstack.push( method );\n\t\t\t\t}\n\t\t\t}\n\t\t\t// stack.shift();\n\t\t\tstack.shift();\n\t\t\tstack.pop();\n\t\t\treturn stack;\n\t\t#elseif cs\n\t\t\treturn makeStack(new cs.system.diagnostics.StackTrace(cs.internal.Exceptions.exception, true));\n\t\t#elseif python\n\t\t\tvar stack = [];\n\t\t\tvar exc = python.lib.Sys.exc_info();\n\t\t\tif (exc._3 != null)\n\t\t\t{\n\t\t\t\tvar infos = python.lib.Traceback.extract_tb(exc._3);\n\t\t\t\tinfos.reverse();\n\t\t\t\tfor (elem in infos)\n\t\t\t\t\tstack.push(FilePos(null, elem._1, elem._2));\n\t\t\t}\n\t\t\treturn stack;\n\t\t#else\n\t\t\treturn []; // Unsupported\n\t\t#end\n\t}\n\n\t/**\n\t\tReturns a representation of the stack as a printable string.\n\t**/\n\tpublic static function toString( stack : Array<StackItem> ) {\n\t\tvar b = new StringBuf();\n\t\tfor( s in stack ) {\n\t\t\tb.add(\"\\nCalled from \");\n\t\t\titemToString(b,s);\n\t\t}\n\t\treturn b.toString();\n\t}\n\n\tprivate static function itemToString( b : StringBuf, s ) {\n\t\tswitch( s ) {\n\t\tcase CFunction:\n\t\t\tb.add(\"a C function\");\n\t\tcase Module(m):\n\t\t\tb.add(\"module \");\n\t\t\tb.add(m);\n\t\tcase FilePos(s,file,line):\n\t\t\tif( s != null ) {\n\t\t\t\titemToString(b,s);\n\t\t\t\tb.add(\" (\");\n\t\t\t}\n\t\t\tb.add(file);\n\t\t\tb.add(\" line \");\n\t\t\tb.add(line);\n\t\t\tif( s != null ) b.add(\")\");\n\t\tcase Method(cname,meth):\n\t\t\tb.add(cname);\n\t\t\tb.add(\".\");\n\t\t\tb.add(meth);\n\t\tcase LocalFunction(n):\n\t\t\tb.add(\"local function #\");\n\t\t\tb.add(n);\n\t\t}\n\t}\n\n\t#if cpp @:noStack #end /* Do not mess up the exception stack */\n\tprivate static function makeStack(s #if cs : cs.system.diagnostics.StackTrace #end) {\n\t\t#if neko\n\t\t\tvar a = new Array();\n\t\t\tvar l = untyped __dollar__asize(s);\n\t\t\tvar i = 0;\n\t\t\twhile( i < l ) {\n\t\t\t\tvar x = s[i++];\n\t\t\t\tif( x == null )\n\t\t\t\t\ta.unshift(CFunction);\n\t\t\t\telse if( untyped __dollar__typeof(x) == __dollar__tstring )\n\t\t\t\t\ta.unshift(Module(new String(x)));\n\t\t\t\telse\n\t\t\t\t\ta.unshift(FilePos(null,new String(untyped x[0]),untyped x[1]));\n\t\t\t}\n\t\t\treturn a;\n\t\t#elseif flash9\n\t\t\tvar a = new Array();\n\t\t\tvar r = ~/at ([^\\/]+?)\\$?(\\/[^\\(]+)?\\(\\)(\\[(.*?):([0-9]+)\\])?/;\n\t\t\tvar rlambda = ~/^MethodInfo-([0-9]+)$/g;\n\t\t\twhile( r.match(s) ) {\n\t\t\t\tvar cl = r.matched(1).split(\"::\").join(\".\");\n\t\t\t\tvar meth = r.matched(2);\n\t\t\t\tvar item;\n\t\t\t\tif( meth == null ) {\n\t\t\t\t\tif( rlambda.match(cl) )\n\t\t\t\t\t\titem = LocalFunction(Std.parseInt(rlambda.matched(1)));\n\t\t\t\t\telse\n\t\t\t\t\t\titem = Method(cl,\"new\");\n\t\t\t\t} else\n\t\t\t\t\titem = Method(cl,meth.substr(1));\n\t\t\t\tif( r.matched(3) != null )\n\t\t\t\t\titem = FilePos( item, r.matched(4), Std.parseInt(r.matched(5)) );\n\t\t\t\ta.push(item);\n\t\t\t\ts = r.matchedRight();\n\t\t\t}\n\t\t\treturn a;\n\t\t#elseif flash\n\t\t\tvar a : Array<String> = untyped __eval__(s);\n\t\t\tvar m = new Array();\n\t\t\tfor( i in 0...a.length - if(s == \"$s\") 2 else 0 ) {\n\t\t\t\tvar d = a[i].split(\"::\");\n\t\t\t\tm.unshift(Method(d[0],d[1]));\n\t\t\t}\n\t\t\treturn m;\n\t\t#elseif php\n\t\t\tif (!untyped __call__(\"isset\", __var__(\"GLOBALS\", s)))\n\t\t\t\treturn [];\n\t\t\tvar a : Array<String> = untyped __var__(\"GLOBALS\", s);\n\t\t\tvar m = [];\n\t\t\tfor( i in 0...a.length - ((s == \"%s\") ? 2 : 0)) {\n\t\t\t\tvar d = a[i].split(\"::\");\n\t\t\t\tm.unshift(Method(d[0],d[1]));\n\t\t\t}\n\t\t\treturn m;\n\t\t#elseif cpp\n\t\t\tvar stack : Array<String> = s;\n\t\t\tvar m = new Array<StackItem>();\n\t\t\tfor(func in stack) {\n\t\t\t\tvar words = func.split(\"::\");\n\t\t\t\tif (words.length==0)\n\t\t\t\t\tm.unshift(CFunction)\n\t\t\t\telse if (words.length==2)\n\t\t\t\t\tm.unshift(Method(words[0],words[1]));\n\t\t\t\telse if (words.length==4)\n\t\t\t\t\tm.unshift(FilePos( Method(words[0],words[1]),words[2],Std.parseInt(words[3])));\n\t\t\t}\n\t\t\treturn m;\n\t\t#elseif js\n\t\t\tif ((untyped __js__(\"typeof\"))(s) == \"string\") {\n\t\t\t\t// Return the raw lines in browsers that don't support prepareStackTrace\n\t\t\t\tvar stack : Array<String> = s.split(\"\\n\");\n\t\t\t\tvar m = [];\n\t\t\t\tfor( line in stack ) {\n\t\t\t\t\tm.push(Module(line)); // A little weird, but better than nothing\n\t\t\t\t}\n\t\t\t\treturn m;\n\t\t\t} else {\n\t\t\t\treturn cast s;\n\t\t\t}\n\t\t#elseif cs\n\t\t\tvar stack = [];\n\t\t\tfor (i in 0...s.FrameCount)\n\t\t\t{\n\t\t\t\tvar frame = s.GetFrame(i);\n\t\t\t\tvar m = frame.GetMethod();\n\n\t\t\t\tvar method = StackItem.Method(m.ReflectedType.ToString(), m.Name);\n\n\t\t\t\tvar fileName = frame.GetFileName();\n\t\t\t\tvar lineNumber = frame.GetFileLineNumber();\n\n\t\t\t\tif (fileName != null || lineNumber >= 0)\n\t\t\t\t\tstack.push(FilePos(method, fileName, lineNumber));\n\t\t\t\telse\n\t\t\t\t\tstack.push(method);\n\t\t\t}\n\t\t\treturn stack;\n\t\t#else\n\t\t\treturn null;\n\t\t#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tLog primarily provides the trace() method, which is invoked upon a call to\n\ttrace() in haxe code.\n**/\nclass Log {\n\n\t/**\n\t\tOutputs `v` in a platform-dependent way.\n\n\t\tThe second parameter `infos` is injected by the compiler and contains\n\t\tinformation about the position where the trace() call was made.\n\n\t\tThis method can be rebound to a custom function:\n\t\t\tvar oldTrace = haxe.Log.trace; // store old function\n\t\t\thaxe.Log.trace = function(v,infos) { // handle trace }\n\t\t\t...\n\t\t\thaxe.Log.trace = oldTrace;\n\n\t\tIf it is bound to null, subsequent calls to trace() will cause an\n\t\texception.\n\t**/\n\tpublic static dynamic function trace( v : Dynamic, ?infos : PosInfos ) : Void {\n\t\t#if flash\n\t\t\t#if (fdb || native_trace)\n\t\t\t\tvar pstr = infos == null ? \"(null)\" : infos.fileName + \":\" + infos.lineNumber;\n\t\t\t\tvar str = flash.Boot.__string_rec(v, \"\");\n\t\t\t\tif( infos != null && infos.customParams != null ) for( v in infos.customParams ) str += \",\" + flash.Boot.__string_rec(v, \"\");\n\t\t\t\tuntyped #if flash9 __global__[\"trace\"] #else __trace__ #end(pstr+\": \"+str);\n\t\t\t#else\n\t\t\t\tuntyped flash.Boot.__trace(v,infos);\n\t\t\t#end\n\t\t#elseif neko\n\t\t\tuntyped {\n\t\t\t\t$print(infos.fileName + \":\" + infos.lineNumber + \": \", v);\n\t\t\t\tif( infos.customParams != null ) for( v in infos.customParams ) $print(\",\", v);\n\t\t\t\t$print(\"\\n\");\n\t\t\t}\n\t\t#elseif js\n\t\t\tuntyped js.Boot.__trace(v,infos);\n\t\t#elseif php\n\t\t\tif (infos!=null && infos.customParams!=null) {\n\t\t\t\tvar extra:String = \"\";\n\t\t\t\tfor( v in infos.customParams )\n\t\t\t\t\textra += \",\" + v;\n\t\t\t\tuntyped __call__('_hx_trace', v + extra, infos);\n\t\t\t}\n\t\t\telse\n\t\t\t\tuntyped __call__('_hx_trace', v, infos);\n\t\t#elseif cpp\n\t\t\tif (infos!=null && infos.customParams!=null) {\n\t\t\t\tvar extra:String = \"\";\n\t\t\t\tfor( v in infos.customParams )\n\t\t\t\t\textra += \",\" + v;\n\t\t\t\tuntyped __trace(v + extra,infos);\n\t\t\t}\n\t\t\telse\n\t\t\t\tuntyped __trace(v,infos);\n\t\t#elseif (cs || java)\n\t\t\tvar str:String = null;\n\t\t\tif (infos != null) {\n\t\t\t\tstr = infos.fileName + \":\" + infos.lineNumber + \": \" + v;\n\t\t\t\tif (infos.customParams != null)\n\t\t\t\t{\n\t\t\t\t\tstr += \",\" + infos.customParams.join(\",\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstr = v;\n\t\t\t}\n\t\t\t#if cs\n\t\t\tcs.system.Console.WriteLine(str);\n\t\t\t#elseif java\n\t\t\tuntyped __java__(\"java.lang.System.out.println(str)\");\n\t\t\t#end\n\t\t#elseif (python)\n\t\t\tvar str:String = null;\n\t\t\tif (infos != null) {\n\t\t\t\tstr = infos.fileName + \":\" + Std.string(infos.lineNumber) + \": \" + v;\n\t\t\t\tif (infos.customParams != null) {\n\t\t\t\t\tstr += \",\" + infos.customParams.join(\",\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstr = v;\n\t\t\t}\n\t\t\tpython.Lib.println(str);\n\t\t#end\n\t}\n\n\t#if (flash || js)\n\t/**\n\t\tClears the trace output.\n\t**/\n\tpublic static dynamic function clear() : Void {\n\t\t#if flash\n\t\tuntyped flash.Boot.__clear_trace();\n\t\t#elseif js\n\t\tuntyped js.Boot.__clear_trace();\n\t\t#end\n\t}\n\t#end\n\n\t#if flash\n\t/**\n\t\tSets the color of the trace output to `rgb`.\n\t**/\n\tpublic static dynamic function setColor( rgb : Int ) {\n\t\tuntyped flash.Boot.__set_trace_color(rgb);\n\t}\n\t#end\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.ds;\n\n@:coreApi class StringMap<T> implements Map.IMap<String,T> {\n\n\tprivate var h : Dynamic;\n\n\tpublic function new() : Void {\n\t\th = {};\n\t}\n\n\tpublic function set( key : String, value : T ) : Void {\n\t\tuntyped h[\"$\"+key] = value;\n\t}\n\n\tpublic function get( key : String ) : Null<T> {\n\t\treturn untyped h[\"$\"+key];\n\t}\n\n\tpublic function exists( key : String ) : Bool {\n\t\treturn untyped h.hasOwnProperty(\"$\"+key);\n\t}\n\n\tpublic function remove( key : String ) : Bool {\n\t\tkey = \"$\"+key;\n\t\tif( untyped !h.hasOwnProperty(key) ) return false;\n\t\tuntyped __js__(\"delete\")(h[key]);\n\t\treturn true;\n\t}\n\n\tpublic function keys() : Iterator<String> {\n\t\tvar a = [];\n\t\tuntyped {\n\t\t\t__js__(\"for( var key in this.h ) {\");\n\t\t\t\tif( h.hasOwnProperty(key) )\n\t\t\t\t\ta.push(key.substr(1));\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a.iterator();\n\t}\n\n\tpublic function iterator() : Iterator<T> {\n\t\treturn untyped {\n\t\t\tref : h,\n\t\t\tit : keys(),\n\t\t\thasNext : function() { return __this__.it.hasNext(); },\n\t\t\tnext : function() { var i = __this__.it.next(); return __this__.ref[\"$\"+i]; }\n\t\t};\n\t}\n\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar it = keys();\n\t\tfor( i in it ) {\n\t\t\ts.add(i);\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(i)));\n\t\t\tif( it.hasNext() )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js;\n\nclass Boot {\n\n\tprivate static function __unhtml(s : String) {\n\t\treturn s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n\t}\n\n\tprivate static function __trace(v,i : haxe.PosInfos) {\n\t\tuntyped {\n\t\t\tvar msg = if( i != null ) i.fileName+\":\"+i.lineNumber+\": \" else \"\";\n\t\t\t#if jsfl\n\t\t\tmsg += __string_rec(v,\"\");\n\t\t\tfl.trace(msg);\n\t\t\t#else\n\t\t\tmsg += __string_rec(v, \"\");\n\t\t\tif( i != null && i.customParams != null )\n\t\t\t\tfor( v in i.customParams )\n\t\t\t\t\tmsg += \",\" + __string_rec(v, \"\");\n\t\t\tvar d;\n\t\t\tif( __js__(\"typeof\")(document) != \"undefined\" && (d = document.getElementById(\"haxe:trace\")) != null )\n\t\t\t\td.innerHTML += __unhtml(msg)+\"<br/>\";\n\t\t\telse if( __js__(\"typeof console\") != \"undefined\" && __js__(\"console\").log != null )\n\t\t\t\t__js__(\"console\").log(msg);\n\t\t\t#end\n\t\t}\n\t}\n\n\tprivate static function __clear_trace() {\n\t\tuntyped {\n\t\t\t#if jsfl\n\t\t\tfl.outputPanel.clear();\n\t\t\t#else\n\t\t\tvar d = document.getElementById(\"haxe:trace\");\n\t\t\tif( d != null )\n\t\t\t\td.innerHTML = \"\";\n\t\t\t#end\n\t\t}\n\t}\n\n\tstatic inline function isClass(o:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isClass\", o.__name__);\n\t}\n\n\tstatic inline function isEnum(e:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isEnum\", e.__ename__);\n\t}\n\n\tstatic inline function getClass(o:Dynamic) : Dynamic {\n\t\tif (Std.is(o, Array))\n\t\t\treturn Array;\n\t\telse\n\t\t\treturn untyped __define_feature__(\"js.Boot.getClass\", o.__class__);\n\t}\n\n\t@:ifFeature(\"may_print_enum\")\n\tprivate static function __string_rec(o,s:String) {\n\t\tuntyped {\n\t\t\tif( o == null )\n\t\t\t    return \"null\";\n\t\t\tif( s.length >= 5 )\n\t\t\t\treturn \"<...>\"; // too much deep recursion\n\t\t\tvar t = __js__(\"typeof(o)\");\n\t\t\tif( t == \"function\" && (isClass(o) || isEnum(o)) )\n\t\t\t\tt = \"object\";\n\t\t\tswitch( t ) {\n\t\t\tcase \"object\":\n\t\t\t\tif( __js__(\"o instanceof Array\") ) {\n\t\t\t\t\tif( o.__enum__ ) {\n\t\t\t\t\t\tif( o.length == 2 )\n\t\t\t\t\t\t\treturn o[0];\n\t\t\t\t\t\tvar str = o[0]+\"(\";\n\t\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\t\tfor( i in 2...o.length ) {\n\t\t\t\t\t\t\tif( i != 2 )\n\t\t\t\t\t\t\t\tstr += \",\" + __string_rec(o[i],s);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tstr += __string_rec(o[i],s);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn str + \")\";\n\t\t\t\t\t}\n\t\t\t\t\tvar l = o.length;\n\t\t\t\t\tvar i;\n\t\t\t\t\tvar str = \"[\";\n\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\tfor( i in 0...l )\n\t\t\t\t\t\tstr += (if (i > 0) \",\" else \"\")+__string_rec(o[i],s);\n\t\t\t\t\tstr += \"]\";\n\t\t\t\t\treturn str;\n\t\t\t\t}\n\t\t\t\tvar tostr;\n\t\t\t\ttry {\n\t\t\t\t\ttostr = untyped o.toString;\n\t\t\t\t} catch( e : Dynamic ) {\n\t\t\t\t\t// strange error on IE\n\t\t\t\t\treturn \"???\";\n\t\t\t\t}\n\t\t\t\tif( tostr != null && tostr != __js__(\"Object.toString\") ) {\n\t\t\t\t\tvar s2 = o.toString();\n\t\t\t\t\tif( s2 != \"[object Object]\")\n\t\t\t\t\t\treturn s2;\n\t\t\t\t}\n\t\t\t\tvar k : String = null;\n\t\t\t\tvar str = \"{\\n\";\n\t\t\t\ts += \"\\t\";\n\t\t\t\tvar hasp = (o.hasOwnProperty != null);\n\t\t\t\t__js__(\"for( var k in o ) {\");\n\t\t\t\t\tif( hasp && !o.hasOwnProperty(k) )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( k == \"prototype\" || k == \"__class__\" || k == \"__super__\" || k == \"__interfaces__\" || k == \"__properties__\" )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( str.length != 2 )\n\t\t\t\t\t\tstr += \", \\n\";\n\t\t\t\t\tstr += s + k + \" : \"+__string_rec(o[k],s);\n\t\t\t\t__js__(\"}\");\n\t\t\t\ts = s.substring(1);\n\t\t\t\tstr += \"\\n\" + s + \"}\";\n\t\t\t\treturn str;\n\t\t\tcase \"function\":\n\t\t\t\treturn \"<function>\";\n\t\t\tcase \"string\":\n\t\t\t\treturn o;\n\t\t\tdefault:\n\t\t\t\treturn String(o);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static function __interfLoop(cc : Dynamic,cl : Dynamic) {\n\t\tif( cc == null )\n\t\t\treturn false;\n\t\tif( cc == cl )\n\t\t\treturn true;\n\t\tvar intf : Dynamic = cc.__interfaces__;\n\t\tif( intf != null )\n\t\t\tfor( i in 0...intf.length ) {\n\t\t\t\tvar i : Dynamic = intf[i];\n\t\t\t\tif( i == cl || __interfLoop(i,cl) )\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\treturn __interfLoop(cc.__super__,cl);\n\t}\n\n\t@:ifFeature(\"typed_catch\") private static function __instanceof(o : Dynamic,cl : Dynamic) {\n\t\tif( cl == null )\n\t\t\treturn false;\n\t\tswitch( cl ) {\n\t\tcase Int:\n\t\t\treturn (untyped __js__(\"(o|0) === o\"));\n\t\tcase Float:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"number\";\n\t\tcase Bool:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"boolean\";\n\t\tcase String:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"string\";\n\t\tcase Array:\n\t\t\treturn (untyped __js__(\"(o instanceof Array)\")) && o.__enum__ == null;\n\t\tcase Dynamic:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\tif( o != null ) {\n\t\t\t\t// Check if o is an instance of a Haxe class\n\t\t\t\tif( (untyped __js__(\"typeof\"))(cl) == \"function\" ) {\n\t\t\t\t\tif( untyped __js__(\"o instanceof cl\") ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tif( __interfLoop(getClass(o),cl) )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// do not use isClass/isEnum here\n\t\t\tuntyped __feature__(\"Class.*\",if( cl == Class && o.__name__ != null ) return true);\n\t\t\tuntyped __feature__(\"Enum.*\",if( cl == Enum && o.__ename__ != null ) return true);\n\t\t\treturn o.__enum__ == cl;\n\t\t}\n\t}\n\n\t@:ifFeature(\"typed_cast\") private static function __cast(o : Dynamic, t : Dynamic) {\n\t\tif (__instanceof(o, t)) return o;\n\t\telse throw \"Cannot cast \" +Std.string(o) + \" to \" +Std.string(t);\n\t}\n\n}\n","/**\n * ...\n * @author Franco Ponticelli\n */\n\npackage thx.core;\n\nimport thx.core.Functions.Function in F;\n\n#if macro\nimport haxe.macro.Context;\nimport haxe.macro.Expr;\nimport haxe.macro.ExprTools;\n#end\n\nclass Arrays {\n\tpublic static function same<T>(a : Array<T>, b : Array<T>, ?eq : T -> T -> Bool) {\n\t\tif(a == null || b == null || a.length != b.length) return false;\n\t\tif(null == eq) eq = F.equality;\n\t\tfor(i in 0...a.length)\n\t\t\tif(!eq(a[i], b[i]))\n\t\t\t\treturn false;\n\t\treturn true;\n\t}\n\n\tpublic static function cross<T>(a : Array<T>, b : Array<T>) {\n\t\tvar r = [];\n\t\tfor (va in a)\n\t\t\tfor (vb in b)\n\t\t\t\tr.push([va, vb]);\n\t\treturn r;\n\t}\n\n\tpublic static function crossMulti<T>(a : Array<Array<T>>) {\n\t\tvar acopy  = a.copy(),\n\t\t\tresult = acopy.shift().map(function(v) return [v]);\n\t\twhile (acopy.length > 0) {\n\t\t\tvar arr = acopy.shift(),\n\t\t\t\ttresult = result;\n\t\t\tresult = [];\n\t\t\tfor (v in arr) {\n\t\t\t\tfor (ar in tresult) {\n\t\t\t\t\tvar t = ar.copy();\n\t\t\t\t\tt.push(v);\n\t\t\t\t\tresult.push(t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic static function pushIf<T>(arr : Array<T>, cond : Bool, value : T) {\n\t\tif (cond)\n\t\t\tarr.push(value);\n\t\treturn arr;\n\t}\n\n\tpublic static function eachPair<TIn, TOut>(arr : Array<TIn>, handler : TIn -> TIn -> Bool)\n\t\tfor(i in 0...arr.length)\n\t\t\tfor(j in i...arr.length)\n\t\t\t\tif(!handler(arr[i], arr[j]))\n\t\t\t\t\treturn;\n\n\t#if js inline #end\n\tpublic static function mapi<TIn, TOut>(arr : Array<TIn>, handler : TIn -> Int -> TOut) : Array<TOut> {\n\t\t#if js\n\t\t\treturn (cast arr : { map : (TIn -> Int -> TOut) -> Array<TOut> }).map(handler);\n\t\t#else\n\t\t\tvar r = [];\n\t\t\tfor(i in 0...arr.length)\n\t\t\t\tr.push(handler(arr[i], i));\n\t\t\treturn r;\n\t\t#end\n\t}\n\n\tinline public static function flatMap<TIn, TOut>(arr : Array<TIn>, callback : TIn -> Array<TOut>) : Array<TOut>\n\t\treturn flatten(arr.map(callback));\n\n\t#if js inline #end\n\tpublic static function flatten<T>(arr : Array<Array<T>>) : Array<T>\n\t\t#if js\n\t\t\treturn untyped __js__('Array.prototype.concat.apply')([], arr);\n\t\t#else\n\t\t\treturn reduce(arr, function(acc : Array<T>, item) return acc.concat(item), []);\n\t\t#end\n\n\tinline public static function reduce<TItem, TAcc>(arr : Array<TItem>, callback : TAcc -> TItem -> TAcc, initial : TAcc) : TAcc\n\t\t#if js\n\t\t\treturn untyped arr.reduce(callback, initial);\n\t\t#else\n\t\t\treturn Iterables.reduce(arr, callback, initial);\n\t\t#end\n\n\tinline public static function reducei<TItem, TAcc>(arr : Array<TItem>, callback : TAcc -> TItem -> Int -> TAcc, initial : TAcc) : TAcc\n\t\t#if js\n\t\t\treturn untyped arr.reduce(callback, initial);\n\t\t#else\n\t\t\treturn Iterables.reducei(arr, callback, initial);\n\t\t#end\n\n\tpublic static function order<T>(arr : Array<T>, sort : T -> T -> Int) {\n\t\tvar n = arr.copy();\n\t\tn.sort(sort);\n\t\treturn n;\n\t}\n\n\tinline public static function isEmpty<T>(arr : Array<T>) : Bool\n\t\treturn arr.length == 0;\n\n\tpublic static function contains<T>(arr : Array<T>, element : T, ?eq : T -> T -> Bool) : Bool {\n\t\tif(null == eq) {\n\t\t\treturn arr.indexOf(element) >= 0;\n\t\t} else {\n\t\t\tfor(i in 0...arr.length)\n\t\t\t\tif(eq(arr[i], element))\n\t\t\t\t\treturn true;\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tpublic static function shuffle<T>(a : Array<T>) : Array<T> {\n\t\tvar t = Ints.range(a.length),\n\t\t\tarr = [];\n\t\twhile (t.length > 0) {\n\t\t\tvar pos = Std.random(t.length),\n\t\t\t\tindex = t[pos];\n\t\t\tt.splice(pos, 1);\n\t\t\tarr.push(a[index]);\n\t\t}\n\t\treturn arr;\n\t}\n\n\tpublic static function extract<T>(a : Array<T>, f : T -> Bool) : T {\n\t\tfor(i in 0...a.length) {\n\t\t\tif(f(a[i]))\n\t\t\t\treturn a.splice(i, 1)[0];\n\t\t}\n\t\treturn null;\n\t}\n\n\tmacro public static function mapField<T>(a : ExprOf<Array<T>>, field : Expr) {\n\t\tvar id = 'o.'+ExprTools.toString(field),\n\t\t\t\texpr = Context.parse(id, field.pos);\n\t\treturn macro $e{a}.map(function(o) return ${expr});\n\t}\n\n\tmacro public static function mapFieldi<T>(a : ExprOf<Array<T>>, field : Expr) {\n\t\tvar id = 'o.'+ExprTools.toString(field),\n\t\t\t\texpr = Context.parse(id, field.pos);\n\t\treturn macro thx.core.Arrays.mapi($e{a}, function(o, i) return ${expr});\n\t}\n}","package thx.core;\n\nimport haxe.PosInfos;\nimport haxe.CallStack;\n\nclass Error #if js extends JSError #end {\n\tpublic static function fromDynamic(err : Dynamic, ?pos : PosInfos) : Error {\n\t\tif(Std.is(err, Error))\n\t\t\treturn cast err;\n\t\treturn new Error(\"\"+err, null, pos);\n\t}\n#if !js\n\tpublic var message(default, null) : String;\n#end\n\tpublic var stack(default, null) : Array<StackItem>;\n\tpublic var pos(default, null) : PosInfos;\n\tpublic function new(message : String, ?stack : Array<StackItem>, ?pos : PosInfos) {\n\t\tthis.message = message;\n\t\tif(null == stack) {\n\t\t\tstack = CallStack.exceptionStack();\n\t\t\tif(stack.length == 0)\n\t\t\t\tstack = CallStack.callStack();\n\t\t}\n\t\tthis.stack = stack;\n\t\tthis.pos = pos;\n\t}\n\n#if !js\n\tpublic function toString()\n\t\treturn message + \"from: \" + pos.className + \".\" + pos.methodName + \"() at \" + pos.lineNumber + \"\\n\\n\" + CallStack.toString(stack);\n#end\n}\n\n#if js\n@:native('Error')\nextern class JSError {\n\tpublic var message(default, null) : String;\n\tpublic function toString() : String;\n}\n#end","package thx.core;\n\nclass Function0 {\n\tpublic static function noop() : Void {}\n\tpublic inline static function join(fa : Void -> Void, fb : Void -> Void)\n\t\treturn function() {\n\t\t\tfa();\n\t\t\tfb();\n\t\t}\n\n\tpublic inline static function once(f : Void -> Void)\n\t\treturn function() {\n\t\t\tf();\n\t\t\tf = function(){}\n\t\t};\n}\n\nclass Function1 {\n\tpublic static function noop<T>(_ : T) : Void {}\n\tpublic inline static function compose<TIn, TRet1, TRet2>(fa : TRet2 -> TRet1, fb : TIn -> TRet2)\n\t\treturn function(v : TIn) return fa(fb(v));\n\n\tpublic inline static function join<TIn>(fa : TIn -> Void, fb : TIn -> Void)\n\t\treturn function(v : TIn) {\n\t\t\tfa(v);\n\t\t\tfb(v);\n\t\t}\n}\n\nclass Function {\n\tpublic static function equality<T>(a : T, b : T) return a == b;\n}","/**\n * ...\n * @author Franco Ponticelli\n */\n\npackage thx.core;\n\nclass Ints {\n\tpublic static inline function clamp(v : Int, min : Int, max : Int) : Int\n\t\treturn v < min ? min : (v > max ? max : v);\n\n\tstatic var pattern_parse = ~/^[+-]?(\\d+|0x[0-9A-F]+)$/i;\n\tpublic static function canParse(s : String)\n\t\treturn pattern_parse.match(s);\n\n\tpublic inline static function min(a : Int, b : Int)\n\t\treturn a < b ? a : b;\n\n\tpublic inline static function max(a : Int, b : Int)\n\t\treturn a > b ? a : b;\n\n\t// TODO add proper octal/hex/exp support\n\tpublic static function parse(s : String) {\n\t\tif (s.substr(0, 1) == \"+\")\n\t\t\ts = s.substr(1);\n\t\treturn Std.parseInt(s);\n\t}\n\n\tpublic inline static function compare(a : Int, b : Int)\n\t\treturn a - b;\n\n\tpublic static function range(start : Int, ?stop : Int, step = 1) : Array<Int> {\n\t\tif (null == stop) {\n\t\t\tstop = start;\n\t\t\tstart = 0;\n\t\t}\n\t\tif ((stop - start) / step == Math.POSITIVE_INFINITY) throw \"infinite range\";\n\t\tvar range = [], i = -1, j;\n\t\tif (step < 0)\n\t\t\twhile ((j = start + step * ++i) > stop) range.push(j);\n\t\telse\n\t\t\twhile ((j = start + step * ++i) < stop) range.push(j);\n\t\treturn range;\n\t}\n}","package thx.core;\n\nimport haxe.ds.Option;\n\nclass Options {\n\tpublic static function toValue<T>(option : Option<T>) : Null<T>\n\t\treturn switch option {\n\t\t\tcase None: null;\n\t\t\tcase Some(v) : v;\n\t\t};\n\n\tpublic static function toBool<T>(option : Option<T>) : Bool\n\t\treturn switch option {\n\t\t\tcase None: false;\n\t\t\tcase Some(_) : true;\n\t\t};\n\n\tpublic static function toOption<T>(value : T) : Option<T>\n\t\treturn null == value ? None : Some(value);\n\n\tpublic static function equals<T>(a : Option<T>, b : Option<T>, ?eq : T -> T -> Bool)\n\t\treturn switch [a, b] {\n\t\t\tcase [None, None]: true;\n\t\t\tcase [Some(a), Some(b)]:\n\t\t\t\tif(null == eq)\n\t\t\t\t\teq = function(a, b) return a == b;\n\t\t\t\teq(a,b);\n\t\t\tcase [_, _]:\n\t\t\t\tfalse;\n\t\t};\n\n\tpublic static function equalsValue<T>(a : Option<T>, b : Null<T>, ?eq : T -> T -> Bool)\n\t\treturn equals(a, toOption(b));\n}","package thx.core;\n\n#if !js\nimport haxe.Timer in T;\n#end\n\nclass Timer {\n#if !js\n  static var timers = new Map<Int, haxe.Timer>();\n  static var _id = 0;\n  public static function repeat(callback : Void -> Void, delay : Int) : TimerID {\n    var id = _id++,\n        timer = new T(delay);\n    timer.run = callback;\n    timers.set(id, timer);\n    return id;\n  }\n\n  public static function delay(callback : Void -> Void, delay : Int) : TimerID {\n    var id = _id++,\n        timer = T.delay(function() {\n          callback();\n          clear(id);\n        }, delay);\n    timers.set(id, timer);\n    return id;\n  }\n\n  public static function immediate(callback : Void -> Void) : TimerID\n    return delay(callback, 0);\n\n  public static function clear(id : TimerID) : Void {\n    var timer = timers.get(id);\n    if(null != timer) {\n      timers.remove(id);\n      timer.stop();\n    }\n  }\n\n#else\n  public inline static function repeat(callback : Void -> Void, ms : Int) : TimerID\n    return untyped __js__('setInterval')(callback, ms);\n\n  public inline static function delay(callback : Void -> Void, ms : Int) : TimerID\n    return untyped __js__('setTimeout')(callback, ms);\n\n  public inline static function immediate(callback : Void -> Void) : TimerID\n    return untyped __js__('setImmediate')(callback);\n\n  public inline static function clear(id : TimerID) : Void\n    return untyped __js__('clearTimeout')(id);\n\n  static function __init__() untyped {\n    var scope : Dynamic = __js__('(\"undefined\" !== typeof window && window) || (\"undefined\" !== typeof global && global) || this');\n    if(!scope.setImmediate)\n      scope.setImmediate = function(callback) scope.setTimeout(callback, 0);\n  }\n#end\n}\n\n#if !js\ntypedef TimerID = Int;\n#else\nextern\nclass TimerID {}\n#end","package thx.core;\n\nabstract Tuple0(Nil) {\n\tinline public function new()\n\t\tthis = nil;\n\n\tinline public function toTuple1<T0>(v : T0)\n\t\treturn new Tuple1(v);\n\n\tinline public function toString()\n\t\treturn 'Tuple0()';\n\n\t@:to inline public function toNil()\n\t\treturn this;\n\n\t@:from inline static public function nilToTuple(v : Nil)\n\t\treturn new Tuple0();\n}\n\nabstract Tuple1<T0>(T0) {\n\tinline public function new(_0 : T0)\n\t\tthis = _0;\n\tpublic var _0(get, never) : T0;\n\tinline function get__0() return this;\n\n\tinline public function toTuple2<T1>(v : T1)\n\t\treturn new Tuple2(_0, v);\n\n\tinline public function toString()\n\t\treturn 'Tuple1($_0)';\n}\n\nabstract Tuple2<T0, T1>({ _0 : T0, _1 : T1 }) {\n\tinline public function new(_0 : T0, _1 : T1)\n\t\tthis = { _0 : _0, _1 : _1 };\n\tpublic var _0(get, never) : T0;\n\tpublic var _1(get, never) : T1;\n\tinline function get__0() return this._0;\n\tinline function get__1() return this._1;\n\n\tinline public function toTuple3<T2>(v : T2)\n\t\treturn new Tuple3(_0, _1, v);\n\n\tinline public function toString()\n\t\treturn 'Tuple2($_0,$_1)';\n}\n\nabstract Tuple3<T0, T1, T2>({ _0 : T0, _1 : T1, _2 : T2 }) {\n\tinline public function new(_0 : T0, _1 : T1, _2 : T2)\n\t\tthis = { _0 : _0, _1 : _1, _2 : _2 };\n\tpublic var _0(get, never) : T0;\n\tpublic var _1(get, never) : T1;\n\tpublic var _2(get, never) : T2;\n\tinline function get__0() return this._0;\n\tinline function get__1() return this._1;\n\tinline function get__2() return this._2;\n\n\tinline public function toTuple4<T3>(v : T3)\n\t\treturn new Tuple4(_0, _1, _2, v);\n\n\tinline public function toString()\n\t\treturn 'Tuple3($_0,$_1,$_2)';\n}\n\nabstract Tuple4<T0, T1, T2, T3>({ _0 : T0, _1 : T1, _2 : T2, _3 : T3 }) {\n\tinline public function new(_0 : T0, _1 : T1, _2 : T2, _3 : T3)\n\t\tthis = { _0 : _0, _1 : _1, _2 : _2, _3 : _3 };\n\tpublic var _0(get, never) : T0;\n\tpublic var _1(get, never) : T1;\n\tpublic var _2(get, never) : T2;\n\tpublic var _3(get, never) : T3;\n\tinline function get__0() return this._0;\n\tinline function get__1() return this._1;\n\tinline function get__2() return this._2;\n\tinline function get__3() return this._3;\n\n\tinline public function toTuple5<T4>(v : T4)\n\t\treturn new Tuple5(_0, _1, _2, _3, v);\n\n\tinline public function toString()\n\t\treturn 'Tuple4($_0,$_1,$_2,$_3)';\n}\n\nabstract Tuple5<T0, T1, T2, T3, T4>({ _0 : T0, _1 : T1, _2 : T2, _3 : T3, _4 : T4 }) {\n\tinline public function new(_0 : T0, _1 : T1, _2 : T2, _3 : T3, _4 : T4)\n\t\tthis = { _0 : _0, _1 : _1, _2 : _2, _3 : _3, _4 : _4 };\n\tpublic var _0(get, never) : T0;\n\tpublic var _1(get, never) : T1;\n\tpublic var _2(get, never) : T2;\n\tpublic var _3(get, never) : T3;\n\tpublic var _4(get, never) : T4;\n\tinline function get__0() return this._0;\n\tinline function get__1() return this._1;\n\tinline function get__2() return this._2;\n\tinline function get__3() return this._3;\n\tinline function get__4() return this._4;\n\n\tinline public function toTuple6<T5>(v : T5)\n\t\treturn new Tuple6(_0, _1, _2, _3, _4, v);\n\n\tinline public function toString()\n\t\treturn 'Tuple5($_0,$_1,$_2,$_3,$_4)';\n}\n\nabstract Tuple6<T0, T1, T2, T3, T4, T5>({ _0 : T0, _1 : T1, _2 : T2, _3 : T3, _4 : T4, _5 : T5 }) {\n\tinline public function new(_0 : T0, _1 : T1, _2 : T2, _3 : T3, _4 : T4, _5 : T5)\n\t\tthis = { _0 : _0, _1 : _1, _2 : _2, _3 : _3, _4 : _4, _5 : _5 };\n\tpublic var _0(get, never) : T0;\n\tpublic var _1(get, never) : T1;\n\tpublic var _2(get, never) : T2;\n\tpublic var _3(get, never) : T3;\n\tpublic var _4(get, never) : T4;\n\tpublic var _5(get, never) : T5;\n\tinline function get__0() return this._0;\n\tinline function get__1() return this._1;\n\tinline function get__2() return this._2;\n\tinline function get__3() return this._3;\n\tinline function get__4() return this._4;\n\tinline function get__5() return this._5;\n\n\tinline public function toString()\n\t\treturn 'Tuple6($_0,$_1,$_2,$_3,$_4,$_5)';\n}","package thx.promise;\n\nimport thx.core.Error;\nimport thx.promise.Promise;\n\n@:access(thx.promise.Promise)\nclass Deferred<T> {\n  public var promise(default, null) : Promise<T>;\n  public function new()\n    promise = new Promise<T>();\n\n  public function rejectWith(error : Dynamic)\n    return fulfill(Failure(Error.fromDynamic(error)));\n  public function reject(error : Error)\n    return fulfill(Failure(error));\n  public function resolve(value : T)\n    return fulfill(Success(value));\n  public function fulfill(result : PromiseValue<T>)\n    return promise.setState(result);\n\n  public function toString() return 'Deferred';\n}","package thx.promise;\n\nimport haxe.ds.Option;\nimport thx.core.Error;\nimport thx.core.Tuple;\nimport thx.core.Nil;\nusing thx.core.Options;\nusing thx.core.Arrays;\n\nclass Promise<T> {\n  public static var nil(default, null) : Promise<Nil> = Promise.value(Nil.nil);\n\n  public static function create<T>(callback : (T -> Void) -> (Error -> Void) -> Void) : Promise<T> {\n    var deferred = new Deferred<T>();\n    callback(deferred.resolve, deferred.reject);\n    return deferred.promise;\n  }\n\n  public static function fulfilled<T>(callback : (PromiseValue<T> -> Void) -> Void) : Promise<T> {\n    var deferred = new Deferred<T>();\n    callback(deferred.fulfill);\n    return deferred.promise;\n  }\n\n  public static function all<T>(arr : Array<Promise<T>>) : Promise<Array<T>>\n    return Promise.create(function(resolve, reject) {\n      var results  = [],\n          counter  = 0,\n          hasError = false;\n      arr.mapi(function(p, i) {\n        p.either(function(value) {\n          if(hasError) return;\n          results[i] = value;\n          counter++;\n          if(counter == arr.length)\n            resolve(results);\n        }, function(err) {\n          if(hasError) return;\n          hasError = true;\n          reject(err);\n        });\n      });\n    });\n\n  public static function value<T>(v : T) : Promise<T>\n    return Promise.create(function(resolve, _) resolve(v));\n\n  public static function error<T>(err : Error) : Promise<T>\n    return Promise.create(function(_, reject) reject(err));\n\n  var handlers : Array<PromiseValue<T> -> Void>;\n  var state : Option<PromiseValue<T>>;\n  private function new() {\n    handlers = [];\n    state = None;\n  }\n\n  public function then(handler : PromiseValue<T> -> Void) {\n    handlers.push(handler);\n    update();\n    return this;\n  }\n\n  public function either(success : T -> Void, failure : Error -> Void) {\n    then(function(r) switch r {\n      case Success(value): success(value);\n      case Failure(error): failure(error);\n    });\n    return this;\n  }\n\n  public function success(success : T -> Void)\n    return either(success, function(_){});\n\n  public function failure(failure : Error -> Void)\n    return either(function(_){}, failure);\n\n  public function throwFailure()\n    return failure(function(err) {\n      throw err;\n    });\n\n  public function map<TOut>(handler : PromiseValue<T> -> Promise<TOut>)\n    return Promise.fulfilled(function(fulfill)\n      then(function(result) handler(result).then(fulfill))\n    );\n\n  public function mapEither<TOut>(success : T -> Promise<TOut>, failure : Error -> Promise<TOut>)\n    return map(function(result) return switch result {\n        case Success(value): success(value);\n        case Failure(error): failure(error);\n      });\n\n  public function mapSuccess<TOut>(success : T -> Promise<TOut>)\n    return mapEither(success, function(err) return Promise.error(err));\n\n  public function mapFailure(failure : Error -> Promise<T>)\n    return mapEither(function(value : T) return Promise.value(value), failure);\n\n  public function always(handler : Void -> Void)\n    then(function(_) handler());\n\n  public function mapAlways<TOut>(handler : Void -> Promise<TOut>)\n    map(function(_) return handler());\n\n  public function isResolved()\n    return switch state {\n      case None, Some(Failure(_)): false;\n      case _: true;\n    };\n\n  public function isFailure()\n    return switch state {\n      case None, Some(Success(_)): false;\n      case _: true;\n    };\n\n  public function isComplete()\n    return switch state { case None: false; case Some(_): true; };\n\n  public function toString() return 'Promise';\n\n  function setState(newstate : PromiseValue<T>) {\n    switch state {\n      case None:\n        state = Some(newstate);\n      case Some(r):\n        throw new Error('promise was already $r, can\\'t apply new state $newstate');\n    }\n    update();\n    return this;\n  }\n\n  function update()\n    switch state {\n      case None:\n      case Some(result): {\n        var handler;\n        while(null != (handler = handlers.shift()))\n          handler(result);\n      }\n    };\n}\n\nclass Promises {\n  public static function log<T>(promise : Promise<T>, ?prefix : String = '')\n    return promise.either(\n      function(r) trace('$prefix SUCCESS: $r'),\n      function(e) trace('$prefix ERROR: ${e.toString()}')\n    );\n\n  public static function delay<T>(p : Promise<T>, ?interval : Int) : Promise<T>\n    return p.map(\n      function(r)\n        return Promise.fulfilled(\n          null == interval ?\n            function(fulfill) thx.core.Timer.immediate(fulfill.bind(r)) :\n            function(fulfill) thx.core.Timer.delay(fulfill.bind(r), interval)\n        )\n    );\n\n  public static function join<T1,T2>(p1 : Promise<T1>, p2 : Promise<T2>) : Promise<Tuple2<T1,T2>> {\n    return Promise.create(function(resolve, reject) {\n      var hasError = false,\n        counter = 0,\n        v1 : Null<T1> = null,\n        v2 : Null<T2> = null;\n\n      function complete() {\n        if(counter < 2)\n          return;\n        resolve(new Tuple2(v1, v2));\n      }\n\n      function handleError(error) {\n        if(hasError) return;\n        hasError = true;\n        reject(error);\n      }\n\n      p1.either(function(v) {\n        if(hasError) return;\n        counter++;\n        v1 = v;\n        complete();\n      }, handleError);\n\n      p2.either(function(v) {\n        if(hasError) return;\n        counter++;\n        v2 = v;\n        complete();\n      }, handleError);\n    });\n  }\n}\n\nclass PromiseTuple6 {\n  public static function mapTuple<T1,T2,T3,T4,T5,T6,TOut>(promise : Promise<Tuple6<T1,T2,T3,T4,T5,T6>>, success : T1 -> T2 -> T3 -> T4 -> T5 -> T6 -> Promise<TOut>) : Promise<TOut>\n    return promise.mapSuccess(function(t)\n      return success(t._0, t._1, t._2, t._3, t._4, t._5)\n    );\n\n  public static function tuple<T1,T2,T3,T4,T5,T6>(promise : Promise<Tuple6<T1,T2,T3,T4,T5,T6>>, success : T1 -> T2 -> T3 -> T4 -> T5 -> T6 -> Void, ?failure : Error -> Void)\n    return promise.either(\n      function(t) success(t._0, t._1, t._2, t._3, t._4, t._5),\n      null == failure ? function(_) {} : failure\n    );\n}\n\nclass PromiseTuple5 {\n  public static function join<T1,T2,T3,T4,T5,T6>(p1 : Promise<Tuple5<T1,T2,T3,T4,T5>>, p2 : Promise<T6>) : Promise<Tuple6<T1,T2,T3,T4,T5,T6>> {\n    return Promise.create(function(resolve, reject) {\n      Promises.join(p1, p2)\n        .either(\n          function(t) resolve(t._0.toTuple6(t._1)),\n          function(e) reject(e));\n    });\n  }\n\n  public static function mapTuple<T1,T2,T3,T4,T5,TOut>(promise : Promise<Tuple5<T1,T2,T3,T4,T5>>, success : T1 -> T2 -> T3 -> T4 -> T5 -> Promise<TOut>) : Promise<TOut>\n    return promise.mapSuccess(function(t)\n      return success(t._0, t._1, t._2, t._3, t._4)\n    );\n\n  public static function tuple<T1,T2,T3,T4,T5>(promise : Promise<Tuple5<T1,T2,T3,T4,T5>>, success : T1 -> T2 -> T3 -> T4 -> T5 -> Void, ?failure : Error -> Void)\n    return promise.either(\n      function(t) success(t._0, t._1, t._2, t._3, t._4),\n      null == failure ? function(_) {} : failure\n    );\n}\n\nclass PromiseTuple4 {\n  public static function join<T1,T2,T3,T4,T5>(p1 : Promise<Tuple4<T1,T2,T3,T4>>, p2 : Promise<T5>) : Promise<Tuple5<T1,T2,T3,T4,T5>> {\n    return Promise.create(function(resolve, reject) {\n      Promises.join(p1, p2)\n        .either(\n          function(t) resolve(t._0.toTuple5(t._1)),\n          function(e) reject(e));\n    });\n  }\n\n  public static function mapTuple<T1,T2,T3,T4,TOut>(promise : Promise<Tuple4<T1,T2,T3,T4>>, success : T1 -> T2 -> T3 -> T4 -> Promise<TOut>) : Promise<TOut>\n    return promise.mapSuccess(function(t)\n      return success(t._0, t._1, t._2, t._3)\n    );\n\n  public static function tuple<T1,T2,T3,T4>(promise : Promise<Tuple4<T1,T2,T3,T4>>, success : T1 -> T2 -> T3 -> T4 -> Void, ?failure : Error -> Void)\n    return promise.either(\n      function(t) success(t._0, t._1, t._2, t._3),\n      null == failure ? function(_) {} : failure\n    );\n}\n\nclass PromiseTuple3 {\n  public static function join<T1,T2,T3,T4>(p1 : Promise<Tuple3<T1,T2,T3>>, p2 : Promise<T4>) : Promise<Tuple4<T1,T2,T3,T4>> {\n    return Promise.create(function(resolve, reject) {\n      Promises.join(p1, p2)\n        .either(\n          function(t) resolve(t._0.toTuple4(t._1)),\n          function(e) reject(e));\n    });\n  }\n\n  public static function mapTuple<T1,T2,T3,TOut>(promise : Promise<Tuple3<T1,T2,T3>>, success : T1 -> T2 -> T3 -> Promise<TOut>) : Promise<TOut>\n    return promise.mapSuccess(function(t)\n      return success(t._0, t._1, t._2)\n    );\n\n  public static function tuple<T1,T2,T3>(promise : Promise<Tuple3<T1,T2,T3>>, success : T1 -> T2 -> T3 -> Void, ?failure : Error -> Void)\n    return promise.either(\n      function(t) success(t._0, t._1, t._2),\n      null == failure ? function(_) {} : failure\n    );\n}\n\nclass PromiseTuple2 {\n  public static function join<T1,T2,T3>(p1 : Promise<Tuple2<T1,T2>>, p2 : Promise<T3>) : Promise<Tuple3<T1,T2,T3>> {\n    return Promise.create(function(resolve, reject) {\n      Promises.join(p1, p2)\n        .either(\n          function(t) resolve(t._0.toTuple3(t._1)),\n          function(e) reject(e));\n    });\n  }\n\n  public static function mapTuple<T1,T2,TOut>(promise : Promise<Tuple2<T1,T2>>, success : T1 -> T2 -> Promise<TOut>) : Promise<TOut>\n    return promise.mapSuccess(function(t)\n      return success(t._0, t._1)\n    );\n\n  public static function tuple<T1,T2>(promise : Promise<Tuple2<T1,T2>>, success : T1 -> T2 -> Void, ?failure : Error -> Void)\n    return promise.either(\n      function(t) success(t._0, t._1),\n      null == failure ? function(_) {} : failure\n    );\n}\n\nclass PromiseNil {\n  public static function join<T2>(p1 : Promise<Nil>, p2 : Promise<T2>) : Promise<T2>\n    return Promise.create(function(resolve, reject) {\n      Promises.join(p1, p2)\n        .either(\n          function(t) resolve(t._1),\n          function(e) reject(e));\n    });\n}","package thx.stream;\n\nimport haxe.ds.Option;\nimport thx.core.Error;\nimport thx.core.Nil;\nimport thx.core.Timer in T;\nimport thx.core.Timer.TimerID;\nimport thx.promise.Promise;\nusing thx.core.Options;\nusing thx.core.Tuple;\n\nclass Emitter<T> {\n  public static function create<T>(init : Stream<T> -> Void) : Emitter<T> {\n    return new Emitter(init);\n  }\n\n  var init : Stream<T> -> Void;\n  function new(init : Stream<T> -> Void) {\n    this.init = init;\n  }\n\n  public function sign(subscriber : StreamValue<T> -> Void) : IStream {\n    var stream = new Stream(subscriber);\n    init(stream);\n    return stream;\n  }\n\n  public function subscribe(?pulse : T -> Void, ?fail : Error -> Void, ?end : Bool -> Void) : IStream {\n    pulse = null != pulse ? pulse : function(_) {};\n    fail = null != fail ? fail : function(_) {};\n    end = null != end ? end : function(_) {};\n    var stream = new Stream(function(r) switch r {\n      case Pulse(v): pulse(v);\n      case Failure(e): fail(e);\n      case End(c): end(c);\n    });\n    init(stream);\n    return stream;\n  }\n\n  @:access(thx.stream.Value)\n  @:access(thx.stream.Stream)\n  public function feed(value : Value<T>) : IStream {\n    var stream : Stream<T> = new Stream(null);\n    stream.subscriber = function(r) switch r {\n      case Pulse(v): value.set(v);\n      case Failure(e): stream.fail(e);\n      case End(c): if(c) stream.cancel() else stream.end();\n    };\n    value.upStreams.push(stream);\n    stream.addCleanUp(function() value.upStreams.remove(stream));\n    init(stream);\n    return stream;\n  }\n\n  @:access(thx.stream.Bus)\n  @:access(thx.stream.Stream)\n  public function plug(bus : Bus<T>) : IStream {\n    var stream : Stream<T> = new Stream(null);\n    stream.subscriber = bus.emit;\n    bus.upStreams.push(stream);\n    stream.addCleanUp(function() bus.upStreams.remove(stream));\n    init(stream);\n    return stream;\n  }\n\n  public function delay(time : Int)\n    return new Emitter(function(stream) {\n      var id = T.delay(function() init(stream), time);\n      stream.addCleanUp(T.clear.bind(id));\n    });\n\n  public function debounce(delay : Int)\n    return new Emitter(function(stream) {\n      var id : TimerID = null;\n      stream.addCleanUp(function() T.clear(id));\n      init(new Stream(function(r : StreamValue<T>) {\n        switch r {\n          case Pulse(v):\n            T.clear(id);\n            id = T.delay(stream.pulse.bind(v), delay);\n          case Failure(e): stream.fail(e);\n          case End(true):  stream.cancel();\n          case End(false): T.delay(stream.end, delay);\n        }\n      }));\n    });\n\n  public function map<TOut>(f : T -> Promise<TOut>) : Emitter<TOut>\n    return new Emitter(function(stream) {\n      init(new Stream(function(r) {\n        switch r {\n        case Pulse(v):\n          f(v).either(\n            function(vout) stream.pulse(vout),\n            function(err)  stream.fail(err)\n          );\n        case Failure(e):   stream.fail(e);\n        case End(true):    stream.cancel();\n        case End(false):   stream.end();\n      }}));\n    });\n\n  public function mapValue<TOut>(f : T -> TOut) : Emitter<TOut>\n    return map(function(v) return Promise.value(f(v)));\n\n  // TODO ... have a look at those nasty instream\n  public function takeUntil(f : T -> Promise<Bool>) : Emitter<T>\n    return new Emitter(function(stream) {\n      var instream : Stream<T> = null;\n      instream = new Stream(function(r : StreamValue<T>) switch r {\n        case Pulse(v):\n          f(v).either(\n            function(c : Bool) if(c) {\n              stream.pulse(v);\n            } else {\n              instream.end();\n              stream.end();\n            },\n            stream.fail\n          );\n        case Failure(e):\n          instream.fail(e);\n          stream.fail(e);\n        case End(true):\n          instream.cancel();\n          stream.cancel();\n        case End(false):\n          instream.end();\n          stream.end();\n      });\n      this.init(instream);\n    });\n\n  public function take(count : Int)\n    return takeUntil({\n      var counter = 0;\n      function(_) return Promise.value(counter++ < count);\n    });\n\n  public function audit(handler : T -> Void) : Emitter<T>\n    return mapValue(function(v) {\n      handler(v);\n      return v;\n    });\n\n  public function filter(f : T -> Promise<Bool>) : Emitter<T>\n    return new Emitter(function(stream) {\n      init(new Stream(function(r) switch r {\n        case Pulse(v):\n          f(v).either(\n            function(c)   if(c) stream.pulse(v),\n            function(err) stream.fail(err)\n          );\n        case Failure(e):  stream.fail(e);\n        case End(true):   stream.cancel();\n        case End(false):  stream.end();\n      }));\n    });\n\n  public function filterValue(f : T -> Bool) : Emitter<T>\n    return filter(function(v) return Promise.value(f(v)));\n\n  public function concat(other : Emitter<T>) : Emitter<T>\n    return new Emitter(function(stream) {\n      init(new Stream(function(r) switch r {\n        case Pulse(v):    stream.pulse(v);\n        case Failure(e):  stream.fail(e);\n        case End(true):   stream.cancel();\n        case End(false):  other.init(stream);\n      }));\n    });\n\n  public function merge(other : Emitter<T>) : Emitter<T>\n    return new Emitter(function(stream : Stream<T>) {\n      init(stream);\n      other.init(stream);\n    });\n\n  public function reduce<TOut>(acc : TOut, f : TOut -> T -> TOut) : Emitter<TOut>\n    return new Emitter(function(stream) {\n      init(new Stream(function(r) switch r {\n        case Pulse(v):\n          acc = f(acc, v);\n          stream.pulse(acc);\n        case Failure(e):  stream.fail(e);\n        case End(true):   stream.cancel();\n        case End(false):  stream.end();\n      }));\n    });\n\n  public function toOption() : Emitter<Option<T>>\n    return mapValue(function(v) return null == v ? None : Some(v));\n  public function toNil() : Emitter<Nil>\n    return mapValue(function(_) return nil);\n  public function toTrue() : Emitter<Bool>\n    return mapValue(function(_) return true);\n  public function toFalse() : Emitter<Bool>\n    return mapValue(function(_) return false);\n  public function toValue<T>(value : T) : Emitter<T>\n    return mapValue(function(_) return value);\n  public function log(?prefix : String, ?posInfo : haxe.PosInfos) {\n    prefix = prefix == null ? '': '${prefix}: ';\n    return mapValue(function(v) {\n      haxe.Log.trace('$prefix$v', posInfo);\n      return v;\n    });\n  }\n\n  public function withValue(?expected : T) : Emitter<T>\n    return filterValue(\n      null == expected ?\n        function(v : T) return v != null :\n        function(v : T) return v == expected\n    );\n\n  public function distinct(?equals : T -> T -> Bool) : Emitter<T>\n    return new Emitter(function(stream) {\n      if(null == equals)\n        equals = function(a, b) return a == b;\n      var last : T = null;\n      init(new Stream(function(r) switch r {\n        case Pulse(v):\n          if(equals(v, last))\n            return;\n          last = v;\n          stream.pulse(v);\n        case Failure(e):  stream.fail(e);\n        case End(true):   stream.cancel();\n        case End(false):  stream.end();\n      }));\n    });\n\n  public function pair<TOther>(other : Emitter<TOther>) : Emitter<Tuple2<T, TOther>>\n    return new Emitter(function(stream) {\n      var _0 : Null<T> = null,\n          _1 : Null<TOther> = null;\n      stream.addCleanUp(function() {\n        _0 = null;\n        _1 = null;\n      });\n      function pulse() {\n        if(null == _0 || null == _1)\n          return;\n        stream.pulse(new Tuple2(_0, _1));\n      }\n      init(new Stream(function(r) switch r {\n        case Pulse(v):\n          _0 = v;\n          pulse();\n        case Failure(e):  stream.fail(e);\n        case End(true):   stream.cancel();\n        case End(false):  stream.end();\n      }));\n      other.init(new Stream(function(r) switch r {\n        case Pulse(v):\n          _1 = v;\n          pulse();\n        case Failure(e):  stream.fail(e);\n        case End(true):   stream.cancel();\n        case End(false):  stream.end();\n      }));\n    });\n\n  public function zip<TOther>(other : Emitter<TOther>) : Emitter<Tuple2<T, TOther>>\n    return new Emitter(function(stream) {\n      var _0 : Array<T> = [],\n          _1 : Array<TOther> = [];\n      stream.addCleanUp(function() {\n        _0 = null;\n        _1 = null;\n      });\n      function pulse() {\n        if(_0.length == 0 || _1.length == 0)\n          return;\n        stream.pulse(new Tuple2(_0.shift(), _1.shift()));\n      }\n      init(new Stream(function(r) switch r {\n        case Pulse(v):\n          _0.push(v);\n          pulse();\n        case Failure(e):  stream.fail(e);\n        case End(true):   stream.cancel();\n        case End(false):  stream.end();\n      }));\n      other.init(new Stream(function(r) switch r {\n        case Pulse(v):\n          _1.push(v);\n          pulse();\n        case Failure(e):  stream.fail(e);\n        case End(true):   stream.cancel();\n        case End(false):  stream.end();\n      }));\n    });\n\n  public function sampleBy<TOther>(sampler : Emitter<TOther>) : Emitter<Tuple2<T, TOther>>\n    return new Emitter(function(stream) {\n      var _0 : Null<T> = null,\n          _1 : Null<TOther> = null;\n      stream.addCleanUp(function() {\n        _0 = null;\n        _1 = null;\n      });\n      function pulse() {\n        if(null == _0 || null == _1)\n          return;\n        stream.pulse(new Tuple2(_0, _1));\n      }\n      init(new Stream(function(r) switch r {\n        case Pulse(v):\n          _0 = v;\n        case Failure(e):  stream.fail(e);\n        case End(true):   stream.cancel();\n        case End(false):  stream.end();\n      }));\n      sampler.init(new Stream(function(r) switch r {\n        case Pulse(v):\n          _1 = v;\n          pulse();\n        case Failure(e):  stream.fail(e);\n        case End(true):   stream.cancel();\n        case End(false):  stream.end();\n      }));\n    });\n\n  public function window(size : Int, ?emitWithLess = false) : Emitter<Array<T>>\n    return new Emitter(function(stream) {\n      var buf = [];\n      function pulse() {\n        if(buf.length > size)\n          buf.shift();\n        if(buf.length == size || emitWithLess)\n          stream.pulse(buf.copy());\n      }\n\n      init(new Stream(function(r) switch r {\n        case Pulse(v):\n          buf.push(v);\n          pulse();\n        case Failure(e):  stream.fail(e);\n        case End(true):   stream.cancel();\n        case End(false):  stream.end();\n      }));\n    });\n\n  public function previous() : Emitter<T>\n    return new Emitter(function(stream) {\n      var value : Null<T> = null,\n          first = true;\n      function pulse() {\n        if(first) {\n          first = false;\n          return;\n        }\n        stream.pulse(value);\n      }\n\n      init(new Stream(function(r) switch r {\n        case Pulse(v):\n          pulse();\n          value = v;\n        case Failure(e):  stream.fail(e);\n        case End(true):   stream.cancel();\n        case End(false):  stream.end();\n      }));\n    });\n}\n\nclass EmitterStrings {\n  public static function toBool(emitter : Emitter<String>) : Emitter<Bool>\n    return emitter\n      .mapValue(function(s) return s != null && s != \"\");\n}\n\nclass EmitterInts {\n  public static function toBool(emitter : Emitter<Int>) : Emitter<Bool>\n    return emitter\n      .mapValue(function(i) return i != 0);\n}\n\nclass EmitterOptions {\n  public static function filterOption<T>(emitter : Emitter<Option<T>>) : Emitter<T>\n    return emitter\n      .filterValue(function(opt) return opt.toBool())\n      .mapValue(function(opt) return opt.toValue());\n\n  public static function toValue<T>(emitter : Emitter<Option<T>>) : Emitter<Null<T>>\n    return emitter\n      .mapValue(function(opt) return opt.toValue());\n\n  public static function toBool<T>(emitter : Emitter<Option<T>>) : Emitter<Bool>\n    return emitter\n      .mapValue(function(opt) return opt.toBool());\n\n  public static function either<T>(emitter : Emitter<Option<T>>, ?some : T -> Void, ?none : Void -> Void, ?fail : Error -> Void, ?end : Bool -> Void) {\n    if(null == some) some = function(_) {};\n    if(null == none) none = function() {};\n    return emitter.subscribe(\n        function(o : Option<T>) switch o {\n          case Some(v) : some(v);\n          case None: none();\n        },\n        fail,\n        end\n      );\n  }\n}\n\nclass Emitters {\n  public static function skipNull<T>(emitter : Emitter<Null<T>>) : Emitter<T>\n    return emitter\n      .filterValue(function(value) return null != value);\n}\n\nclass EmitterBools {\n  public static function negate(emitter : Emitter<Bool>)\n    return emitter.mapValue(function(v) return !v);\n}\n\n@:access(thx.stream.Emitter)\nclass EmitterEmitters {\n  public static function flatMap<T>(emitter : Emitter<Emitter<T>>) : Emitter<T>\n    return new Emitter(function(stream) {\n      emitter.init(new Stream(function(r : StreamValue<Emitter<T>>) {\n        switch r {\n          case Pulse(em):  em.init(stream);\n          case Failure(e): stream.fail(e);\n          case End(true):  stream.cancel();\n          case End(false): stream.end();\n        }}));\n    });\n\n  public static function flatten<T>(emitter : Emitter<Array<T>>) : Emitter<T>\n    return new Emitter(function(stream) {\n      emitter.init(new Stream(function(r : StreamValue<Array<T>>) {\n        switch r {\n          case Pulse(arr): arr.map(stream.pulse);\n          case Failure(e): stream.fail(e);\n          case End(true):  stream.cancel();\n          case End(false): stream.end();\n        }}));\n    });\n}\n\nclass EmitterValues {\n  public static function left<TLeft, TRight>(emitter : Emitter<Tuple2<TLeft, TRight>>) : Emitter<TLeft>\n    return emitter.mapValue(function(v) return v._0);\n\n  public static function right<TLeft, TRight>(emitter : Emitter<Tuple2<TLeft, TRight>>) : Emitter<TRight>\n    return emitter.mapValue(function(v) return v._1);\n}","package thx.stream;\n\nimport thx.core.Error;\n\nclass Bus<T> extends Emitter<T> {\n  var downStreams : Array<Stream<T>>;\n  var upStreams : Array<Stream<T>>;\n  public function new() {\n    this.downStreams = [];\n    this.upStreams = [];\n    super(function(stream : Stream<T>) {\n      this.downStreams.push(stream);\n      stream.addCleanUp(function() this.downStreams.remove(stream));\n    });\n  }\n\n  public function emit(value : StreamValue<T>) switch value {\n    case Pulse(v):\n      for(stream in downStreams.copy())\n        stream.pulse(v);\n    case Failure(e):\n      for(stream in downStreams.copy())\n        stream.fail(e);\n    case End(true):\n      for(stream in downStreams.copy())\n        stream.cancel();\n    case End(false):\n      for(stream in downStreams.copy())\n        stream.end();\n  }\n\n  inline public function pulse(value : T)\n    emit(Pulse(value));\n\n  inline public function fail(error : Error)\n    emit(Failure(error));\n\n  inline public function end()\n    emit(End(false));\n\n  inline public function cancel()\n    emit(End(true));\n\n  public function clearStreams()\n    for(stream in downStreams.copy())\n      stream.end();\n\n  public function clearEmitters()\n    for(stream in upStreams.copy())\n      stream.cancel();\n\n  public function clear() {\n    clearEmitters();\n    clearStreams();\n  }\n}","package thx.stream;\n\nimport thx.core.Error;\n\nclass Stream<T> implements IStream {\n\n  var subscriber : StreamValue<T> -> Void;\n  var cleanUps : Array<Void -> Void>;\n  var finalized : Bool;\n  public var canceled(default, null) : Bool;\n  public function new(subscriber : StreamValue<T> -> Void) {\n    this.subscriber = subscriber;\n    this.cleanUps   = [];\n    this.finalized  = false;\n    this.canceled   = false;\n  }\n\n  public function addCleanUp(f : Void -> Void) {\n    cleanUps.push(f);\n  }\n\n  public function pulse(v : T) {\n    subscriber(Pulse(v));\n  }\n\n  public function end() {\n    finalize(End(false));\n  }\n\n  public function cancel() {\n    canceled = true;\n    finalize(End(true));\n  }\n\n  public function fail(error : Error) {\n    finalize(Failure(error));\n  }\n\n  function finalize(signal : StreamValue<T>) {\n    if(finalized) return;\n    finalized = true;\n    while(cleanUps.length > 0)\n      cleanUps.shift()();\n    subscriber(signal);\n    subscriber = function(_) {};\n  }\n}","package thx.stream;\n\nclass Value<T> extends Emitter<T> {\n  var value : T;\n  var downStreams : Array<Stream<T>>;\n  var upStreams : Array<Stream<T>>;\n  public function new(value : T) {\n    this.value = value;\n    this.downStreams = [];\n    this.upStreams = [];\n    super(function(stream : Stream<T>) {\n      this.downStreams.push(stream);\n      stream.addCleanUp(function() this.downStreams.remove(stream));\n      stream.pulse(this.value);\n    });\n  }\n\n  public function get() : T\n    return value;\n\n  public function set(value : T) {\n    if(this.value == value)\n      return;\n    this.value = value;\n    update();\n  }\n\n  public function clearStreams()\n    for(stream in downStreams.copy())\n      stream.end();\n\n  public function clearEmitters()\n    for(stream in upStreams.copy())\n      stream.cancel();\n\n  public function clear() {\n    clearEmitters();\n    clearStreams();\n  }\n\n  function update()\n    for(stream in downStreams.copy())\n      stream.pulse(value);\n}","package thx.stream.dom;\n\nusing StringTools;\nusing thx.core.Nil;\nusing thx.stream.Emitter;\nusing thx.promise.Promise;\nimport js.html.*;\n\nclass Dom {\n  public static function ready() : Promise<Nil> {\n    return Promise.create(function(resolve, _) {\n      js.Browser.document.addEventListener(\"DOMContentLoaded\", function(_) {\n        resolve(nil);\n      }, false);\n    });\n  }\n\n  public static function streamEvent<TEvent : Event>(el : Element, name : String, capture = false) : Emitter<TEvent>\n    return Emitter.create(function(stream) {\n      el.addEventListener(name, stream.pulse, capture);\n      stream.addCleanUp(function() el.removeEventListener(name, stream.pulse, capture));\n    });\n\n  public inline static function streamMouseEvent(el : Element, name : String, capture = false) : Emitter<MouseEvent>\n    return streamEvent(el, name, capture);\n\n  public inline static function streamMouseMove(el : Element, capture = false) : Emitter<MouseEvent>\n    return streamEvent(el, \"mousemove\", capture);\n\n  public inline static function streamMouseDown(el : Element, capture = false) : Emitter<MouseEvent>\n    return streamEvent(el, \"mousedown\", capture);\n\n  public inline static function streamMouseUp(el : Element, capture = false) : Emitter<MouseEvent>\n    return streamEvent(el, \"mouseup\", capture);\n\n  public static function streamKey(el : Element, name : String, capture = false) : Emitter<KeyboardEvent>\n    return Emitter.create({\n      if(!name.startsWith('key'))\n        name = 'key$name';\n      function(stream) {\n        el.addEventListener(name, stream.pulse, capture);\n        stream.addCleanUp(function() el.removeEventListener(name, stream.pulse, capture));\n      }\n    });\n\n  public static function streamFocus(el : Element, capture = false) : Emitter<Bool>\n    return streamEvent(el, 'focus', capture).toTrue().merge(streamEvent(el, 'blur', capture).toFalse());\n\n  public inline static function streamClick(el : Element, capture = false) : Emitter<MouseEvent>\n    return streamMouseEvent(el, 'click', capture);\n\n  public inline static function streamInput(el : InputElement, capture = false) : Emitter<String>\n    return streamMouseEvent(el, 'input', capture).mapValue(function(_) return el.value);\n\n  public static function subscribeText(el : Element, force = false) : String -> Void\n    return function(text : String) if(el.textContent != text || force) el.textContent = text;\n\n  public static function subscribeHTML(el : Element) : String -> Void\n    return function(html : String) el.innerHTML = html;\n\n  public static function subscribeFocus(el : Element) : Bool -> Void\n    return function(focus : Bool) if(focus) el.focus() else el.blur();\n\n  public static function subscribeAttribute<T>(el : Element, name : String) : T -> Void\n    return function(value : T) if(null == value) el.removeAttribute(name) else el.setAttribute(name, cast value);\n\n  public static function subscribeToggleAttribute<T>(el : Element, name : String, ?value : T) : Bool -> Void {\n    if(null == value)\n      value = cast el.getAttribute(name);\n    return function(on) if(on) el.setAttribute(name, cast value) else el.removeAttribute(name);\n  }\n\n  public static function subscribeToggleClass(el : Element, name : String) : Bool -> Void\n    return function(on) if(on) el.classList.add(name) else el.classList.remove(name);\n\n  public static function subscribeToggleVisibility(el : Element) : Bool -> Void {\n    var originalDisplay = el.style.display;\n    if(originalDisplay == 'none')\n      originalDisplay = '';\n    return function(on) if(on) el.style.display = originalDisplay else el.style.display = 'none';\n  }\n}","package udom;\n\nusing StringTools;\nimport js.html.Element;\nimport js.html.NodeList;\nimport thx.core.Nil;\nimport thx.promise.Promise;\n\nclass Html {\n  public static function parseList(html : String) : NodeList {\n    var el = js.Browser.document.createElement('div');\n    el.innerHTML = html;\n    return el.childNodes;\n  }\n\n  public inline static function parseAll(html : String) : Array<Element> {\n    return H.toArray(parseList(html.trim()));\n  }\n\n  // TODO unsafe cast\n  public inline static function parse(html : String) : Element {\n    return cast parseList(html.ltrim())[0];\n  }\n}\n\nclass Query {\n  static var doc : Element = untyped __js__('document');\n  public static function first(selector : String, ?ctx : js.html.Element) : Element {\n    return (ctx != null ? ctx : doc).querySelector(selector);\n  }\n\n  public static function list(selector : String, ?ctx : js.html.Element) : NodeList {\n    return (ctx != null ? ctx : doc).querySelectorAll(selector);\n  }\n\n  public inline static function all(selector : String, ?ctx : js.html.Element) : Array<Element> {\n    return H.toArray(list(selector, ctx));\n  }\n}\n\nprivate class H {\n  public inline static function toArray(list : js.html.NodeList) : Array<Element>\n    return untyped __js__('Array.prototype.slice.call')(list, 0);\n}"],
"names":[],
"mappings":"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"
}